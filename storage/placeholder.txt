Complete this files:
Updated Article Page with loading states
Updated Category Page with loading states
Updated Search Page with loading states
Error Boundary component

Makere sure the user is able to navigate easily between the pages by clicking the links.
Using this information:
Updated Article Page with loading states
Updated Category Page with loading states
Updated Search Page with loading states
Error Boundary component
Usage instructions and testing guide
now these are the backend endpoints that i have for navigating the news and articles: <?php

use App\Http\Controllers\Api\{
    AuthController,
    CategoryController,
    SourceController,
    ArticleController,
    ApiFetchLogController,
    ArticleInteractionController,
    ArticleKeywordController,
    MediastackSettingController,
    FetchScheduleController,
    NewsController,
    AnalyticsController,
    MediaStackController
};
use Illuminate\Support\Facades\Route;
use Illuminate\Http\Request;

/*
|--------------------------------------------------------------------------
| API Routes
|--------------------------------------------------------------------------
*/

// Public API routes (no authentication required)
Route::prefix('v1')->middleware(['throttle:api'])->group(function () {
    
    // ðŸ” AUTHENTICATION ROUTES (Public)
    Route::prefix('auth')->controller(AuthController::class)->group(function () {
        Route::post('register', 'register');          // POST /api/v1/auth/register
        Route::post('login', 'login');                // POST /api/v1/auth/login
    });
    
    // News API for Frontend
    Route::prefix('news')->controller(NewsController::class)->group(function () {
        Route::get('latest', 'latest');
        Route::get('trending', 'trending');
        Route::get('featured', 'featured');
        Route::get('by-category/{category}', 'byCategory');
        Route::get('by-source/{source}', 'bySource');
        Route::get('search', 'search');
        Route::get('categorized', 'categorizedNews');
    });
    
    // Public article routes
    Route::prefix('articles')->controller(ArticleController::class)->group(function () {
        Route::get('/', 'index');
        Route::get('{article}', 'show');
        Route::post('{article}/view', 'recordView');
        Route::get('{article}/related', 'related');
        Route::get('{article}/analytics', 'analytics');
    });
    
    // Public category routes
    Route::get('categories', [CategoryController::class, 'index']);
    Route::get('categories/{category}', [CategoryController::class, 'show']);
    
    // Public source routes
    Route::get('sources', [SourceController::class, 'index']);
    Route::get('sources/{source}', [SourceController::class, 'show']);

    //Testing Connection to MediaStack API
    Route::post('mediastack/test-connection', [MediaStackController::class, 'testConnection']);

});

// Protected API routes (authentication required)
Route::prefix('v1')->middleware(['auth:sanctum', 'throttle:api'])->group(function () {
    
    // ðŸ” AUTHENTICATION ROUTES (Protected)
    Route::prefix('auth')->controller(AuthController::class)->group(function () {
        Route::post('logout', 'logout');              // POST /api/v1/auth/logout
        Route::get('profile', 'profile');             // GET /api/v1/auth/profile
        Route::put('profile', 'updateProfile');       // PUT /api/v1/auth/profile
        Route::post('change-password', 'changePassword'); // POST /api/v1/auth/change-password
    });
    
    // ðŸ‘¤ User-specific routes
    Route::get('user', function (Request $request) {
        return response()->json([
            'success' => true,
            'data' => $request->user()
        ]);
    });
    
    // Admin Article Management
    Route::prefix('admin/articles')->controller(ArticleController::class)->group(function () {
        Route::post('/', 'store');
        Route::put('{article}', 'update');
        Route::delete('{article}', 'destroy');
        Route::patch('{article}/feature', 'feature');
        Route::patch('{article}/unfeature', 'unfeature');
        Route::patch('{article}/activate', 'activate');
        Route::patch('{article}/deactivate', 'deactivate');
        Route::post('sync-mediastack', 'syncFromMediaStack');
    });
    
    // MediaStack Integration
    Route::prefix('mediastack')->controller(MediaStackController::class)->group(function () {
        Route::post('fetch', 'fetchNews');
        Route::post('fetch-latest', 'fetchLatest');
        Route::post('fetch-category/{category}', 'fetchByCategory');
        Route::get('status', 'apiStatus');
        Route::get('usage-stats', 'usageStats');
    });
    
    // Admin Resource Routes
    Route::apiResource('admin/categories', CategoryController::class);
    Route::apiResource('admin/sources', SourceController::class);
    Route::apiResource('admin/fetch-logs', ApiFetchLogController::class);
    Route::apiResource('admin/interactions', ArticleInteractionController::class);
    Route::apiResource('admin/keywords', ArticleKeywordController::class);
    Route::apiResource('admin/settings', MediastackSettingController::class);
    Route::apiResource('admin/schedules', FetchScheduleController::class);
    
    // Analytics Routes
    Route::prefix('analytics')->controller(AnalyticsController::class)->group(function () {
        Route::get('dashboard', 'dashboard');
        Route::get('articles/popular', 'popularArticles');
        Route::get('categories/performance', 'categoryPerformance');
        Route::get('sources/reliability', 'sourceReliability');
        Route::get('interactions/summary', 'interactionsSummary');
    });
});

// Webhook routes (for external integrations)
Route::prefix('webhooks')->middleware(['throttle:webhooks'])->group(function () {
    Route::post('mediastack', [MediaStackController::class, 'webhook']);
});
Now from the landing page,the user can go to these pages:
import React, { useState, useEffect, useMemo } from 'react';
import { useParams, Link, useSearchParams } from 'react-router-dom';
import { getArticleById, getRelatedArticles, categories } from '../data/dataService';
import { selectRandomAd, selectMultipleAds } from '../utils/randomAdSelector';
import { formatFullDate } from '../utils/formatDate';
import { paginate } from '../utils/paginationHelpers';
import {type Ad } from '../types';
import ShareButtons from '../components/ShareButtons';
import RelatedArticles from '../components/RelatedArticles';
import AdBanner from '../components/AdBanner';
import Pagination from '../components/Pagination';

const ArticlePage: React.FC = () => {
  const { articleId } = useParams<{ articleId: string }>();
  const [searchParams, setSearchParams] = useSearchParams();
  const [sidebarAd, setSidebarAd] = useState<Ad | null>(null);
  const [inlineAds, setInlineAds] = useState<Ad[]>([]);
  const [bottomAd, setBottomAd] = useState<Ad | null>(null);
  const [relatedPage, setRelatedPage] = useState(parseInt(searchParams.get('relatedPage') || '1'));
  const [relatedItemsPerPage, setRelatedItemsPerPage] = useState(parseInt(searchParams.get('relatedPerPage') || '2'));

  const article = articleId ? getArticleById(articleId) : null;
  const allRelatedArticles = article ? getRelatedArticles(article, 12) : []; // Fetch more related articles
  const category = article ? categories.find(cat => cat.slug === article.category) : null;

  // Paginate related articles
  const paginatedRelatedArticles = useMemo(() => {
    return paginate(allRelatedArticles, relatedPage, relatedItemsPerPage);
  }, [allRelatedArticles, relatedPage, relatedItemsPerPage]);

  useEffect(() => {
    if (article) {
      // Load ads based on article category and keywords
      const sidebar = selectRandomAd(article.category, 'sidebar');
      const inline = selectMultipleAds('article', 2, 'inline');
      const bottom = selectRandomAd(article.category, 'bottom');
      
      setSidebarAd(sidebar);
      setInlineAds(inline);
      setBottomAd(bottom);
    }
  }, [article]);

  useEffect(() => {
    // Scroll to top when article changes
    window.scrollTo(0, 0);
    // Reset related articles pagination when article changes
    setRelatedPage(1);
  }, [articleId]);

  useEffect(() => {
    // Update URL with related articles pagination parameters
    const newParams = new URLSearchParams(searchParams);
    if (relatedPage > 1) {
      newParams.set('relatedPage', relatedPage.toString());
    } else {
      newParams.delete('relatedPage');
    }
    if (relatedItemsPerPage !== 2) {
      newParams.set('relatedPerPage', relatedItemsPerPage.toString());
    } else {
      newParams.delete('relatedPerPage');
    }
    setSearchParams(newParams, { replace: true });
  }, [relatedPage, relatedItemsPerPage]);

  const handleRelatedPageChange = (page: number) => {
    setRelatedPage(page);
    // Scroll to related articles section smoothly
    const relatedSection = document.getElementById('related-articles-section');
    if (relatedSection) {
      relatedSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  };

  const handleRelatedItemsPerPageChange = (newItemsPerPage: number) => {
    setRelatedItemsPerPage(newItemsPerPage);
    setRelatedPage(1); // Reset to first page
  };

  if (!article) {
    return (
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <div className="text-center">
          <h1 className="text-3xl font-bold text-gray-900 mb-4">Article Not Found</h1>
          <p className="text-gray-600 mb-8">The requested article does not exist.</p>
          <Link to="/" className="text-primary-600 hover:text-primary-700 font-medium">
            Return to Home
          </Link>
        </div>
      </div>
    );
  }

  const currentUrl = window.location.href;

  // Split content into paragraphs for ad insertion
  const contentParagraphs = article.content.split('\n\n');

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
        {/* Main Content */}
        <article className="lg:col-span-3">
          {/* Breadcrumb */}
          <nav className="mb-6">
            <ol className="flex items-center space-x-2 text-sm text-gray-500">
              <li>
                <Link to="/" className="hover:text-primary-600">Home</Link>
              </li>
              <li>
                <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path fillRule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clipRule="evenodd" />
                </svg>
              </li>
              <li>
                <Link 
                  to={`/category/${article.category}`} 
                  className="hover:text-primary-600 capitalize"
                >
                  {category?.name || article.category}
                </Link>
              </li>
              <li>
                <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path fillRule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clipRule="evenodd" />
                </svg>
              </li>
              <li className="text-gray-700 truncate">
                {article.title}
              </li>
            </ol>
          </nav>

          {/* Article Header */}
          <header className="mb-8">
            <div className="mb-4">
              <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium capitalize ${
                article.category === 'world' ? 'bg-red-100 text-red-800' :
                article.category === 'business' ? 'bg-green-100 text-green-800' :
                article.category === 'technology' ? 'bg-blue-100 text-blue-800' :
                article.category === 'sports' ? 'bg-orange-100 text-orange-800' :
                article.category === 'health' ? 'bg-purple-100 text-purple-800' :
                article.category === 'science' ? 'bg-indigo-100 text-indigo-800' :
                'bg-gray-100 text-gray-800'
              }`}>
                {category?.name || article.category}
              </span>
            </div>
            
            <h1 className="text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 mb-6 leading-tight">
              {article.title}
            </h1>
            
            <p className="text-xl text-gray-600 mb-6 leading-relaxed">
              {article.summary}
            </p>
            
            <div className="flex flex-wrap items-center justify-between gap-4 mb-6 pb-6 border-b border-gray-200">
              <div className="flex items-center space-x-4">
                <div className="flex items-center space-x-2">
                  <div className="w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center">
                    <span className="text-white font-semibold text-sm">
                      {article.author.split(' ').map(n => n[0]).join('')}
                    </span>
                  </div>
                  <div>
                    <p className="font-semibold text-gray-900">{article.author}</p>
                    <p className="text-sm text-gray-500">{formatFullDate(article.publishedAt)}</p>
                  </div>
                </div>
                <div className="flex items-center space-x-4 text-sm text-gray-500">
                  <span className="flex items-center space-x-1">
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <span>{article.readTime} min read</span>
                  </span>
                </div>
              </div>
              
              <ShareButtons
                url={currentUrl}
                title={article.title}
                description={article.summary}
              />
            </div>
          </header>

          {/* Featured Image */}
          <div className="mb-8">
            <img
              src={article.imageUrl}
              alt={article.title}
              className="w-full h-64 md:h-96 object-cover rounded-lg shadow-lg"
            />
          </div>

          {/* Article Content */}
          <div className="prose prose-lg max-w-none mb-12">
            {contentParagraphs.map((paragraph, index) => (
              <div key={index}>
                <p className="text-gray-800 leading-relaxed mb-6 text-lg">
                  {paragraph}
                </p>
                
                {/* Insert inline ad after 2nd and 4th paragraphs */}
                {((index === 1 && inlineAds[0]) || (index === 3 && inlineAds[1])) && (
                  <div className="my-8">
                    <AdBanner 
                      ad={index === 1 ? inlineAds[0] : inlineAds[1]} 
                      placement="article" 
                    />
                  </div>
                )}
              </div>
            ))}
          </div>

          {/* Article Tags */}
          <div className="mb-8 pb-8 border-b border-gray-200">
            <h3 className="text-lg font-semibold text-gray-900 mb-4">Tags</h3>
            <div className="flex flex-wrap gap-2">
              {article.tags.map((tag) => (
                <span
                  key={tag}
                  className="inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors"
                >
                  #{tag}
                </span>
              ))}
            </div>
          </div>

          {/* Share Section */}
          <div className="mb-12 p-6 bg-gray-50 rounded-lg">
            <div className="text-center">
              <h3 className="text-lg font-semibold text-gray-900 mb-4">
                Enjoyed this article? Share it with others!
              </h3>
              <div className="flex justify-center">
                <ShareButtons
                  url={currentUrl}
                  title={article.title}
                  description={article.summary}
                />
              </div>
            </div>
          </div>

          {/* Related Articles with Pagination */}
          {allRelatedArticles.length > 0 && (
            <div id="related-articles-section" className="mb-12 scroll-mt-24">
              <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
                <h2 className="text-2xl font-bold text-gray-900">Related Articles</h2>
                
                {/* Items per page selector for related articles */}
                {allRelatedArticles.length > 2 && (
                  <div className="flex items-center space-x-3">
                    <label htmlFor="related-items-per-page" className="text-sm font-medium text-gray-700 whitespace-nowrap">
                      Show:
                    </label>
                    <select
                      id="related-items-per-page"
                      value={relatedItemsPerPage}
                      onChange={(e) => handleRelatedItemsPerPageChange(parseInt(e.target.value))}
                      className="px-3 py-1.5 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                    >
                      <option value="2">2 articles</option>
                      <option value="4">4 articles</option>
                      <option value="6">6 articles</option>
                      <option value="12">12 articles</option>
                    </select>
                  </div>
                )}
              </div>

              {/* Results info */}
              {allRelatedArticles.length > relatedItemsPerPage && (
                <div className="mb-4">
                  <p className="text-sm text-gray-600">
                    Showing {Math.min((relatedPage - 1) * relatedItemsPerPage + 1, allRelatedArticles.length)}-
                    {Math.min(relatedPage * relatedItemsPerPage, allRelatedArticles.length)} of{' '}
                    <span className="font-semibold">{allRelatedArticles.length}</span> related articles
                  </p>
                </div>
              )}

              <RelatedArticles
                articles={paginatedRelatedArticles.items}
                title=""
                className=""
              />

              {/* Pagination for related articles */}
              {paginatedRelatedArticles.totalPages > 1 && (
                <div className="mt-8">
                  <Pagination
                    currentPage={paginatedRelatedArticles.currentPage}
                    totalPages={paginatedRelatedArticles.totalPages}
                    onPageChange={handleRelatedPageChange}
                  />
                </div>
              )}
            </div>
          )}
        </article>

        {/* Sidebar */}
        <aside className="lg:col-span-1">
          <div className="sticky top-24 space-y-8">
            {/* Sidebar Ad */}
            {sidebarAd && (
              <AdBanner ad={sidebarAd} placement="article" />
            )}

            {/* Article Info */}
            <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
              <h3 className="text-lg font-semibold text-gray-900 mb-4">Article Info</h3>
              <dl className="space-y-3">
                <div>
                  <dt className="text-sm font-medium text-gray-500">Category</dt>
                  <dd className="text-sm text-gray-900 capitalize">
                    <Link 
                      to={`/category/${article.category}`}
                      className="hover:text-primary-600"
                    >
                      {category?.name || article.category}
                    </Link>
                  </dd>
                </div>
                <div>
                  <dt className="text-sm font-medium text-gray-500">Published</dt>
                  <dd className="text-sm text-gray-900">{formatFullDate(article.publishedAt)}</dd>
                </div>
                <div>
                  <dt className="text-sm font-medium text-gray-500">Read Time</dt>
                  <dd className="text-sm text-gray-900">{article.readTime} minutes</dd>
                </div>
                <div>
                  <dt className="text-sm font-medium text-gray-500">Author</dt>
                  <dd className="text-sm text-gray-900">{article.author}</dd>
                </div>
              </dl>
            </div>

            {/* Newsletter Signup */}
            <div className="bg-primary-50 rounded-lg p-6 border border-primary-200">
              <h3 className="text-lg font-semibold text-gray-900 mb-2">Stay Updated</h3>
              <p className="text-sm text-gray-600 mb-4">
                Get the latest {category?.name.toLowerCase() || 'news'} articles delivered to your inbox.
              </p>
              <form className="space-y-3">
                <input
                  type="email"
                  placeholder="Your email"
                  className="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                />
                <button
                  type="submit"
                  className="w-full px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700 transition-colors"
                >
                  Subscribe
                </button>
              </form>
            </div>

            {/* Other Categories */}
            <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
              <h3 className="text-lg font-semibold text-gray-900 mb-4">Explore Other Topics</h3>
              <div className="space-y-2">
                {categories
                  .filter(cat => cat.slug !== article.category)
                  .slice(0, 5)
                  .map((cat) => (
                    <Link
                      key={cat.id}
                      to={`/category/${cat.slug}`}
                      className="block px-3 py-2 rounded-md text-gray-700 hover:bg-gray-100 hover:text-primary-600 transition-colors capitalize"
                    >
                      {cat.name}
                    </Link>
                  ))}
              </div>
            </div>
          </div>
        </aside>
      </div>

      {/* Bottom Ad (Mobile) */}
      {bottomAd && (
        <div className="mt-12 lg:hidden">
          <AdBanner ad={bottomAd} placement="article" />
        </div>
      )}
    </div>
  );
};

export default ArticlePage;
import React, { useState, useEffect, useMemo } from 'react';
import { useParams, useSearchParams } from 'react-router-dom';
import { categories, getArticlesByCategory } from '../data/dataService';
import { selectRandomAd, selectMultipleAds } from '../utils/randomAdSelector';
import { paginate } from '../utils/paginationHelpers';
import { filterArticlesBySearch, sortArticles } from '../utils/filterArticles';
import {type Ad,type Article } from '../types';
import NewsCard from '../components/NewsCard';
import AdBanner from '../components/AdBanner';
import Pagination from '../components/Pagination';
import SearchBar from '../components/SearchBar';
import CompactNewsCard from '../components/CompactNewsCard';

const CategoryPage: React.FC = () => {
  const { categorySlug } = useParams<{ categorySlug: string }>();
  const [searchParams, setSearchParams] = useSearchParams();
  
  const [sidebarAd, setSidebarAd] = useState<Ad | null>(null);
  const [inlineAds, setInlineAds] = useState<Ad[]>([]);
  const [searchQuery, setSearchQuery] = useState(searchParams.get('search') || '');
  const [sortBy, setSortBy] = useState<'date' | 'title' | 'readTime'>('date');
  const [currentPage, setCurrentPage] = useState(parseInt(searchParams.get('page') || '1'));
  const [itemsPerPage, setItemsPerPage] = useState(parseInt(searchParams.get('perPage') || '4'));

  // Get category information
  const category = categories.find(cat => cat.slug === categorySlug);
  
  // Get and filter articles
  const allCategoryArticles = categorySlug ? getArticlesByCategory(categorySlug) : [];
  
  const filteredAndSortedArticles = useMemo(() => {
    let articles = allCategoryArticles;
    
    // Apply search filter
    if (searchQuery.trim()) {
      articles = filterArticlesBySearch(articles, searchQuery);
    }
    
    // Apply sorting
    articles = sortArticles(articles, sortBy);
    
    return articles;
  }, [allCategoryArticles, searchQuery, sortBy]);

  // Paginate articles
  const paginatedData = useMemo(() => {
    return paginate(filteredAndSortedArticles, currentPage, itemsPerPage);
  }, [filteredAndSortedArticles, currentPage, itemsPerPage]);

  useEffect(() => {
    // Load ads for this category
    const sidebar = selectRandomAd(categorySlug || 'category', 'sidebar');
    const inline = selectMultipleAds(categorySlug || 'category', 2, 'inline');
    
    setSidebarAd(sidebar);
    setInlineAds(inline);
  }, [categorySlug]);

  useEffect(() => {
    // Update URL with search, page, and perPage parameters
    const newParams = new URLSearchParams();
    if (searchQuery) newParams.set('search', searchQuery);
    if (currentPage > 1) newParams.set('page', currentPage.toString());
    if (itemsPerPage !== 4) newParams.set('perPage', itemsPerPage.toString());
    setSearchParams(newParams);
  }, [searchQuery, currentPage, itemsPerPage, setSearchParams]);

  const handleSearch = (query: string) => {
    setSearchQuery(query);
    setCurrentPage(1); // Reset to first page when searching
  };

  const handleSortChange = (newSortBy: 'date' | 'title' | 'readTime') => {
    setSortBy(newSortBy);
    setCurrentPage(1); // Reset to first page when sorting
  };

  const handlePageChange = (page: number) => {
    setCurrentPage(page);
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleItemsPerPageChange = (newItemsPerPage: number) => {
    setItemsPerPage(newItemsPerPage);
    setCurrentPage(1); // Reset to first page when changing items per page
  };

  // Create articles with inline ads inserted
  const articlesWithAds = useMemo(() => {
    const items: (Article | Ad)[] = [];
    
    paginatedData.items.forEach((article, index) => {
      items.push(article);
      
      // Insert inline ad after every 3rd article
      if ((index + 1) % 3 === 0 && inlineAds[Math.floor(index / 3)]) {
        items.push(inlineAds[Math.floor(index / 3)]);
      }
    });
    
    return items;
  }, [paginatedData.items, inlineAds]);

  if (!category) {
    return (
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <div className="text-center">
          <h1 className="text-3xl font-bold text-gray-900 mb-4">Category Not Found</h1>
          <p className="text-gray-600 mb-8">The requested category does not exist.</p>
          <a href="/" className="text-primary-600 hover:text-primary-700 font-medium">
            Return to Home
          </a>
        </div>
      </div>
    );
  }

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2">
      <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
        {/* Main Content */}
        <div className="lg:col-span-3">
          {/* Category Header */}
          <div className="mb-1">
            <h1 className="text-4xl font-bold text-gray-900 mb-2 capitalize">
              {category.name}
            </h1>
            <p className="text-lg text-gray-600 mb-1">
              {category.description}
            </p>
            <div className="w-16 h-1 bg-primary-600 rounded"></div>
          </div>

          {/* Controls */}
          <div className="flex flex-col gap-4 mb-6 p-4 bg-white rounded-lg shadow-sm border border-gray-200">
            <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
              <div className="flex-1 max-w-md">
                <SearchBar
                  onSearch={handleSearch}
                  initialValue={searchQuery}
                  placeholder={`Search in ${category.name}...`}
                />
              </div>
              
              <div className="flex items-center space-x-4">
                <label htmlFor="sort-select" className="text-sm font-medium text-gray-700 whitespace-nowrap">
                  Sort by:
                </label>
                <select
                  id="sort-select"
                  value={sortBy}
                  onChange={(e) => handleSortChange(e.target.value as 'date' | 'title' | 'readTime')}
                  className="px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                >
                  <option value="date">Latest</option>
                  <option value="title">Title A-Z</option>
                  <option value="readTime">Read Time</option>
                </select>
              </div>
            </div>

            {/* Items per page selector */}
           <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 pt-4 border-t border-gray-200">
  {/* Items per page selector */}
  <div className="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3">
    <label
      htmlFor="items-per-page"
      className="text-sm font-medium text-gray-700 whitespace-nowrap"
    >
      Articles per page:
    </label>
    <select
      id="items-per-page"
      value={itemsPerPage}
      onChange={(e) => handleItemsPerPageChange(parseInt(e.target.value))}
      className="px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 w-full sm:w-auto"
    >
      <option value="4">4 articles</option>
      <option value="8">8 articles</option>
      <option value="12">12 articles</option>
      <option value="20">20 articles</option>
    </select>
  </div>

  {/* Results count indicator */}
  <div className="text-sm text-gray-600 text-center sm:text-right">
    {filteredAndSortedArticles.length > 0 && (
      <span>
        Showing{" "}
        {Math.min(
          (currentPage - 1) * itemsPerPage + 1,
          filteredAndSortedArticles.length
        )}
        -
        {Math.min(
          currentPage * itemsPerPage,
          filteredAndSortedArticles.length
        )}{" "}
        of{" "}
        <span className="font-semibold">
          {filteredAndSortedArticles.length}
        </span>
      </span>
    )}
  </div>
</div>

          </div>

          {/* Results Info */}
          <div className="mb-6">
            <p className="text-gray-600">
              {searchQuery ? (
                <>
                  Found <span className="font-semibold">{filteredAndSortedArticles.length}</span> articles 
                  for "<span className="font-semibold">{searchQuery}</span>" in {category.name}
                </>
              ) : (
                <>
                  <span className="font-semibold">{filteredAndSortedArticles.length}</span> total articles 
                  in {category.name}
                </>
              )}
            </p>
          </div>

          {/* Articles */}
          {paginatedData.items.length > 0 ? (
           <div className="space-y-8">
  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
    {articlesWithAds.map((item, index) => {
      if ("clickUrl" in item) {
        // It's an ad
        return (
          <div key={`ad-${item.id}-${index}`} className="md:col-span-2">
            <AdBanner ad={item} placement={categorySlug || "category"} />
          </div>
        );
      } else {
        // It's an article â†’ Show compact on mobile, regular on md+
        return (
          <div key={item.id}>
            {/* Mobile version */}
            <div className="md:hidden">
              <CompactNewsCard article={item} />
            </div>

            {/* Desktop version */}
            <div className="hidden md:block">
              <NewsCard
                article={item}
                variant="compact"
                showImage={true}
              />
            </div>
          </div>
        );
      }
    })}
  </div>

  {/* Pagination */}
  {paginatedData.totalPages > 1 && (
    <div className="mt-3">
      <Pagination
        currentPage={paginatedData.currentPage}
        totalPages={paginatedData.totalPages}
        onPageChange={handlePageChange}
      />
    </div>
  )}
</div>

          ) : (
            <div className="text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300">
              <div className="mb-4">
                <svg className="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.47-.881-6.08-2.33" />
                </svg>
              </div>
              <h3 className="text-lg font-medium text-gray-900 mb-2">No articles found</h3>
              <p className="text-gray-600 mb-4">
                {searchQuery 
                  ? `No articles match your search "${searchQuery}" in ${category.name}.`
                  : `No articles available in ${category.name} at the moment.`
                }
              </p>
              {searchQuery && (
                <button
                  onClick={() => handleSearch('')}
                  className="inline-flex items-center px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700 transition-colors"
                >
                  Clear search
                </button>
              )}
            </div>
          )}
        </div>

        {/* Sidebar */}
        <div className="lg:col-span-1">
          <div className="sticky top-24 space-y-8">
            {/* Sidebar Ad */}
            {sidebarAd && (
              <AdBanner ad={sidebarAd} placement={categorySlug || 'category'} />
            )}

            {/* Popular Categories */}
            <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
              <h3 className="text-lg font-semibold text-gray-900 mb-4">Other Categories</h3>
              <div className="space-y-2">
                {categories
                  .filter(cat => cat.slug !== categorySlug)
                  .slice(0, 5)
                  .map((cat) => (
                    <a
                      key={cat.id}
                      href={`/category/${cat.slug}`}
                      className="block px-3 py-2 rounded-md text-gray-700 hover:bg-gray-100 hover:text-primary-600 transition-colors capitalize"
                    >
                      {cat.name}
                    </a>
                  ))}
              </div>
            </div>

            {/* Newsletter Signup */}
            <div className="bg-primary-50 rounded-lg p-6 border border-primary-200">
              <h3 className="text-lg font-semibold text-gray-900 mb-2">Stay Updated</h3>
              <p className="text-sm text-gray-600 mb-4">
                Get the latest {category.name.toLowerCase()} news delivered to your inbox.
              </p>
              <form className="space-y-3">
                <input
                  type="email"
                  placeholder="Your email"
                  className="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                />
                <button
                  type="submit"
                  className="w-full px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700 transition-colors"
                >
                  Subscribe
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default CategoryPage;
import React, { useState, useEffect, useMemo, useRef } from 'react';
import { useSearchParams, useNavigate } from 'react-router-dom';
import { searchArticles, categories } from '../data/dataService';
import { selectRandomAd } from '../utils/randomAdSelector';
import { paginate } from '../utils/paginationHelpers';
import { sortArticles } from '../utils/filterArticles';
import {type Ad } from '../types';
import NewsCard from '../components/NewsCard';
import AdBanner from '../components/AdBanner';
import Pagination from '../components/Pagination';
import SearchBar from '../components/SearchBar';

const SearchPage: React.FC = () => {
  const [searchParams, setSearchParams] = useSearchParams();
  const navigate = useNavigate();
  
  const [sidebarAd, setSidebarAd] = useState<Ad | null>(null);
  const [sortBy, setSortBy] = useState<'date' | 'title' | 'readTime'>('date');
  
  // Use ref to prevent infinite loops
  const isInitialMount = useRef(true);
  const isInternalUpdate = useRef(false);
  
  // Read directly from URL params instead of maintaining separate state
  const searchQuery = searchParams.get('q') || '';
  const currentPage = parseInt(searchParams.get('page') || '1');
  const selectedCategory = searchParams.get('category') || 'all';
  
  const itemsPerPage = 8;

  // Search and filter articles
  const searchResults = useMemo(() => {
    if (!searchQuery.trim()) return [];
    
    let results = searchArticles(searchQuery);
    
    // Filter by category if selected
    if (selectedCategory && selectedCategory !== 'all') {
      results = results.filter(article => article.category === selectedCategory);
    }
    
    // Apply sorting
    results = sortArticles(results, sortBy);
    
    return results;
  }, [searchQuery, selectedCategory, sortBy]);

  // Paginate results
  const paginatedData = useMemo(() => {
    return paginate(searchResults, currentPage, itemsPerPage);
  }, [searchResults, currentPage, itemsPerPage]);

  useEffect(() => {
    // Load sidebar ad only once
    const sidebar = selectRandomAd('category', 'sidebar');
    setSidebarAd(sidebar);
  }, []);

  // Scroll to top only when search query changes from user action
  useEffect(() => {
    if (isInitialMount.current) {
      isInitialMount.current = false;
      return;
    }
    
    if (searchQuery && !isInternalUpdate.current) {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    isInternalUpdate.current = false;
  }, [searchQuery]);

  const updateSearchParams = (updates: { q?: string; page?: number; category?: string }) => {
    isInternalUpdate.current = true;
    const newParams = new URLSearchParams(searchParams);
    
    // Update query
    if (updates.q !== undefined) {
      if (updates.q) {
        newParams.set('q', updates.q);
      } else {
        newParams.delete('q');
      }
    }
    
    // Update page
    if (updates.page !== undefined) {
      if (updates.page > 1) {
        newParams.set('page', updates.page.toString());
      } else {
        newParams.delete('page');
      }
    }
    
    // Update category
    if (updates.category !== undefined) {
      if (updates.category && updates.category !== 'all') {
        newParams.set('category', updates.category);
      } else {
        newParams.delete('category');
      }
    }
    
    setSearchParams(newParams, { replace: true });
  };

  const handleSearch = (query: string) => {
    updateSearchParams({ q: query, page: 1 });
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleCategoryChange = (category: string) => {
    updateSearchParams({ category, page: 1 });
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleSortChange = (newSortBy: 'date' | 'title' | 'readTime') => {
    setSortBy(newSortBy);
    updateSearchParams({ page: 1 });
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handlePageChange = (page: number) => {
    updateSearchParams({ page });
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleClearSearch = () => {
    navigate('/');
  };

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <div className="grid grid-cols-1 lg:grid-cols-4 gap-4">
        {/* Main Content */}
        <div className="lg:col-span-3">
          {/* Search Header */}
          <div className="mb-2">
            <h1 className="text-3xl md:text-4xl font-bold text-gray-900 mb-2">
              Search Results
            </h1>
            {searchQuery && (
              <p className="text-lg text-gray-600 mb-1">
                Results for "<span className="font-semibold">{searchQuery}</span>"
                {selectedCategory && selectedCategory !== 'all' && (
                  <> in <span className="font-semibold capitalize">{selectedCategory}</span></>
                )}
              </p>
            )}
            <div className="w-16 h-1 bg-primary-600 rounded"></div>
          </div>

          {/* Search Controls */}
          <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200 mb-3">
            <div className="space-y-4">
              {/* Search Bar - Show button on mobile */}
              <div>
                <SearchBar
                  onSearch={handleSearch}
                  initialValue={searchQuery}
                  placeholder="Search articles, authors, topics..."
                  className="w-full"
                  showButton={true}
                />
              </div>

              {/* Filters */}
              <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                <div className="flex items-center space-x-4">
                  <label htmlFor="category-filter" className="text-sm font-medium text-gray-700">
                    Category:
                  </label>
                  <select
                    id="category-filter"
                    value={selectedCategory}
                    onChange={(e) => handleCategoryChange(e.target.value)}
                    className="px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  >
                    <option value="all">All Categories</option>
                    {categories.map((category) => (
                      <option key={category.id} value={category.slug} className="capitalize">
                        {category.name}
                      </option>
                    ))}
                  </select>
                </div>

                <div className="flex items-center space-x-4">
                  <label htmlFor="sort-select" className="text-sm font-medium text-gray-700">
                    Sort by:
                  </label>
                  <select
                    id="sort-select"
                    value={sortBy}
                    onChange={(e) => handleSortChange(e.target.value as 'date' | 'title' | 'readTime')}
                    className="px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  >
                    <option value="date">Latest</option>
                    <option value="title">Title A-Z</option>
                    <option value="readTime">Read Time</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          {/* Results */}
          {searchQuery ? (
            searchResults.length > 0 ? (
              <div className="space-y-8">
                {/* Results Count */}
                <div className="flex items-center justify-between">
                  <p className="text-gray-600">
                    Found <span className="font-semibold">{searchResults.length}</span> article{searchResults.length !== 1 ? 's' : ''}
                  </p>
                  <button
                    onClick={handleClearSearch}
                    className="text-sm text-primary-600 hover:text-primary-700 font-medium"
                  >
                    Clear search
                  </button>
                </div>

                {/* Articles Grid */}
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  {paginatedData.items.map((article) => (
                    <NewsCard
                      key={article.id}
                      article={article}
                      variant="medium"
                      showImage={true}
                    />
                  ))}
                </div>

                {/* Pagination */}
                {paginatedData.totalPages > 1 && (
                  <div className="mt-12">
                    <Pagination
                      currentPage={paginatedData.currentPage}
                      totalPages={paginatedData.totalPages}
                      onPageChange={handlePageChange}
                    />
                  </div>
                )}
              </div>
            ) : (
              <div className="text-center py-12">
                <div className="mb-4">
                  <svg className="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.47-.881-6.08-2.33" />
                  </svg>
                </div>
                <h3 className="text-lg font-medium text-gray-900 mb-2">No results found</h3>
                <p className="text-gray-600 mb-4">
                  No articles match your search "{searchQuery}"
                  {selectedCategory && selectedCategory !== 'all' && (
                    <> in {selectedCategory}</>
                  )}.
                </p>
                <div className="space-y-2">
                  <p className="text-sm text-gray-500">Try:</p>
                  <ul className="text-sm text-gray-500 space-y-1">
                    <li>â€¢ Using different keywords</li>
                    <li>â€¢ Checking your spelling</li>
                    <li>â€¢ Removing category filter</li>
                    <li>â€¢ Using more general terms</li>
                  </ul>
                </div>
                <button
                  onClick={handleClearSearch}
                  className="mt-6 text-primary-600 hover:text-primary-700 font-medium"
                >
                  Browse all articles
                </button>
              </div>
            )
          ) : (
            <div className="text-center py-12">
              <div className="mb-4">
                <svg className="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
              </div>
              <h3 className="text-lg font-medium text-gray-900 mb-2">Start your search</h3>
              <p className="text-gray-600 mb-4">
                Enter keywords to find articles on topics you're interested in.
              </p>
            </div>
          )}
        </div>

        {/* Sidebar */}
        <div className="lg:col-span-1">
          <div className="sticky top-24 space-y-8">
            {/* Sidebar Ad */}
            {sidebarAd && (
              <AdBanner ad={sidebarAd} placement="category" />
            )}

            {/* Popular Categories */}
            <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
              <h3 className="text-lg font-semibold text-gray-900 mb-4">Browse Categories</h3>
              <div className="space-y-2">
                {categories.map((category) => (
                  <button
                    key={category.id}
                    onClick={() => handleCategoryChange(category.slug)}
                    className={`block w-full text-left px-3 py-2 rounded-md transition-colors capitalize ${
                      selectedCategory === category.slug
                        ? 'bg-primary-100 text-primary-700'
                        : 'text-gray-700 hover:bg-gray-100 hover:text-primary-600'
                    }`}
                  >
                    {category.name}
                  </button>
                ))}
              </div>
            </div>

            {/* Search Tips */}
            <div className="bg-primary-50 rounded-lg p-6 border border-primary-200">
              <h3 className="text-lg font-semibold text-gray-900 mb-2">Search Tips</h3>
              <ul className="text-sm text-gray-600 space-y-2">
                <li>â€¢ Use specific keywords for better results</li>
                <li>â€¢ Try searching for author names</li>
                <li>â€¢ Search within specific categories</li>
                <li>â€¢ Use quotes for exact phrases</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default SearchPage;
import React, { useState, useEffect, useMemo } from 'react';
import { Link } from 'react-router-dom';
import { categories, getArticlesByCategory, getFeaturedArticles } from '../data/dataService';
import { selectRandomAd, selectMultipleAds } from '../utils/randomAdSelector';
import { type Ad, type Article } from '../types';
import NewsCard from '../components/NewsCard';
import AdBanner from '../components/AdBanner';
import Pagination from '../components/Pagination';
import CategoryNavigation from '../components/CategoryNavigation';
import './styles/landing.css';

const ARTICLES_PER_PAGE = 3; // Show 3 articles after the first one

const LandingPage: React.FC = () => {
  const [featuredAds, setFeaturedAds] = useState<Ad[]>([]);
  const [sidebarAd, setSidebarAd] = useState<Ad | null>(null);
  const [categoryArticles, setCategoryArticles] = useState<Map<string, Article[]>>(new Map());
  const [featuredArticle, setFeaturedArticle] = useState<Article | null>(null);
  const [loading, setLoading] = useState(true);
  
  // Pagination state for each category
  const [currentPages, setCurrentPages] = useState<Map<string, number>>(new Map());
  
  // Category navigation state
  const [currentCategoryIndex, setCurrentCategoryIndex] = useState(0);

  // Generate random layout order
  const randomLayoutOrder = useMemo(() => {
    const layouts = [
      'hero-asymmetric',
      'wide-triple',
      'magazine-sidebar',
      'masonry-stack',
      'spotlight-flow',
      'alternating-media-text',
      'carousel-grid',
      'editorial-split',
      'timeline-feed',
      'visual-mosaic'
    ];
    
    const shuffled = [...layouts];
    for (let i = shuffled.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    
    return shuffled;
  }, []);

  useEffect(() => {
    const loadData = async () => {
      try {
        setLoading(true);
        
        // Load ads
        const bannerAds = selectMultipleAds('landing', 2, 'banner');
        const sidebar = selectRandomAd('landing', 'sidebar');
        setFeaturedAds(bannerAds);
        setSidebarAd(sidebar);

        // Load featured article
        try {
          const featured = await getFeaturedArticles();
          if (featured && featured.length > 0) {
            setFeaturedArticle(featured[0]);
          }
        } catch (error) {
          console.error('Failed to load featured article:', error);
        }

        // Load articles for each category
        const articlesMap = new Map();
        const pagesMap = new Map();
        
        for (const category of categories) {
          try {
            // Load more articles to support pagination
            const articles = await getArticlesByCategory(category.slug, 20); // Load more for pagination
            articlesMap.set(category.slug, Array.isArray(articles) ? articles : []);
            pagesMap.set(category.slug, 1); // Start each category at page 1
          } catch (error) {
            console.error(`Failed to load articles for category ${category.slug}:`, error);
            articlesMap.set(category.slug, []);
            pagesMap.set(category.slug, 1);
          }
        }
        
        setCategoryArticles(articlesMap);
        setCurrentPages(pagesMap);
      } catch (error) {
        console.error('Failed to load landing page data:', error);
      } finally {
        setLoading(false);
      }
    };

    loadData();
  }, []);

  // Handle page change for a specific category
  const handlePageChange = (categorySlug: string, page: number) => {
    setCurrentPages(prev => new Map(prev.set(categorySlug, page)));
  };

  // Handle category navigation
  const handleCategoryChange = (index: number) => {
    setCurrentCategoryIndex(index);
    // Scroll to the category section
    const categoryElement = document.querySelector(`[data-category="${categories[index].slug}"]`);
    if (categoryElement) {
      categoryElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  };

  // Get paginated articles for a category
  const getPaginatedArticles = (categorySlug: string): Article[] => {
    const articles = categoryArticles.get(categorySlug) || [];
    const currentPage = currentPages.get(categorySlug) || 1;
    
    if (articles.length <= 1) return articles;
    
    // First article is always shown, then paginate the rest
    const firstArticle = articles[0];
    const remainingArticles = articles.slice(1);
    
    const startIndex = (currentPage - 1) * ARTICLES_PER_PAGE;
    const endIndex = startIndex + ARTICLES_PER_PAGE;
    const paginatedRemaining = remainingArticles.slice(startIndex, endIndex);
    
    return [firstArticle, ...paginatedRemaining];
  };

  // Calculate total pages for a category
  const getTotalPages = (categorySlug: string): number => {
    const articles = categoryArticles.get(categorySlug) || [];
    if (articles.length <= 1) return 1;
    
    const remainingArticles = articles.length - 1;
    return Math.ceil(remainingArticles / ARTICLES_PER_PAGE);
  };

  // Dynamic layout configuration
  const getLayoutConfig = (index: number) => {
    const layoutName = randomLayoutOrder[index % randomLayoutOrder.length];
    
    const layoutMap: { [key: string]: any } = {
      'hero-asymmetric': {
        name: 'hero-asymmetric',
        description: 'Prominent hero story with secondary cards arranged asymmetrically.'
      },
      'wide-triple': {
        name: 'wide-triple',
        description: 'A cinematic wide headline article followed by a balanced three-column flow.'
      },
      'magazine-sidebar': {
        name: 'magazine-sidebar',
        description: 'Editorial-style grid with visual hierarchy and an adaptive sidebar for trending topics.'
      },
      'masonry-stack': {
        name: 'masonry-stack',
        description: 'Pinterest-inspired card stacking for high visual variation and content depth.'
      },
      'spotlight-flow': {
        name: 'spotlight-flow',
        description: 'Highlight key articles with spotlight emphasis and grid-based secondary flow.'
      },
      'alternating-media-text': {
        name: 'alternating-media-text',
        description: 'Visually rhythmic layout alternating image positions for a storytelling vibe.'
      },
      'carousel-grid': {
        name: 'carousel-grid',
        description: 'Horizontal swipeable carousel on mobile, expanding into a multi-row grid on desktop.'
      },
      'editorial-split': {
        name: 'editorial-split',
        description: 'Newspaper-style split view with a pull quote or featured text area to break repetition.'
      },
      'timeline-feed': {
        name: 'timeline-feed',
        description: 'Chronological feed emphasizing publication dates and linear storytelling.'
      },
      'visual-mosaic': {
        name: 'visual-mosaic',
        description: 'Highly visual, image-dominant layout resembling a photo journal or artboard.'
      }
    };

    return layoutMap[layoutName];
  };

  // Safe article destructuring
  const getArticlesForLayout = (articles: Article[]) => {
    if (!Array.isArray(articles) || articles.length === 0) {
      return { firstArticle: null, secondArticle: null, remainingArticles: [] };
    }
    
    const [firstArticle, secondArticle, ...remainingArticles] = articles;
    return { firstArticle, secondArticle, remainingArticles };
  };

  // Render layout component
  const renderCategoryLayout = (layoutConfig: any, articles: Article[]) => {
    const { firstArticle, secondArticle, remainingArticles } = getArticlesForLayout(articles);
    
    if (!firstArticle) {
      return (
        <div className="text-center py-8 text-gray-500">
          No articles available for this category.
        </div>
      );
    }

    switch(layoutConfig.name) {
      case 'hero-asymmetric':
        return (
          <div className="space-y-3 md:space-y-0 md:grid md:grid-cols-1 lg:grid-cols-3 md:gap-5 lg:gap-6">
            <div className="lg:col-span-2">
              <NewsCard 
                article={firstArticle} 
                variant="large" 
                priority="high"
                isFirstInCategory={true}
                showCategory={true}
              />
            </div>
            <div className="space-y-3 md:space-y-5 md:grid md:grid-cols-2 md:gap-5 lg:grid-cols-1">
              {secondArticle && (
                <NewsCard 
                  article={secondArticle} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              )}
              {remainingArticles.map((article) => (
                <NewsCard 
                  key={article.id} 
                  article={article} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              ))}
            </div>
          </div>
        );

      case 'wide-triple':
        return (
          <div className="space-y-3 md:space-y-5 lg:space-y-6">
            <div>
              <NewsCard 
                article={firstArticle} 
                variant="wide" 
                priority="high"
                isFirstInCategory={true}
                showCategory={true}
              />
            </div>
            <div className="space-y-3 md:space-y-0 md:grid md:grid-cols-2 lg:grid-cols-3 md:gap-5 lg:gap-6">
              {secondArticle && (
                <div className="md:col-span-2 lg:col-span-1">
                  <NewsCard 
                    article={secondArticle} 
                    variant="compact" 
                    orientation="horizontal"
                    isFirstInCategory={false}
                    hideMetaMobile={true}
                    showCategory={true}
                  />
                </div>
              )}
              {remainingArticles.map((article) => (
                <NewsCard 
                  key={article.id} 
                  article={article} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              ))}
            </div>
          </div>
        );

      default:
        // Default layout
        return (
          <div className="space-y-3 md:space-y-0 md:grid md:grid-cols-2 lg:grid-cols-3 md:gap-5 lg:gap-6">
            <div className="lg:col-span-2">
              <NewsCard 
                article={firstArticle} 
                variant="large" 
                priority="high"
                isFirstInCategory={true}
                showCategory={true}
              />
            </div>
            <div className="space-y-3 md:space-y-5 md:grid md:grid-cols-2 md:gap-5 lg:grid-cols-1">
              {secondArticle && (
                <NewsCard 
                  article={secondArticle} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              )}
              {remainingArticles.map((article) => (
                <NewsCard 
                  key={article.id} 
                  article={article} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              ))}
            </div>
          </div>
        );
    }
  };

  // Loading state
  if (loading) {
    return (
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-8">
        <div className="animate-pulse">
          {/* Featured section skeleton */}
          <div className="mb-10 md:mb-12 -mx-4 sm:mx-7">
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-10 sm:gap-6 lg:gap-8">
              <div className="lg:col-span-2 space-y-4">
                <div className="h-8 bg-gray-200 rounded w-1/4 mb-4"></div>
                <div className="h-96 bg-gray-200 rounded"></div>
              </div>
              <div className="h-64 bg-gray-200 rounded"></div>
            </div>
          </div>
          
          {/* Categories skeleton */}
          <div className="space-y-10 md:space-y-20">
            {categories.map((category, index) => (
              <div key={category.id} className="space-y-4">
                <div className="h-8 bg-gray-200 rounded w-1/3"></div>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                  {[...Array(4)].map((_, i) => (
                    <div key={i} className="h-48 bg-gray-200 rounded"></div>
                  ))}
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-8">
      {/* Featured Article Showcase */}
      {featuredArticle && (
        <section className="mb-10 md:mb-12 -mx-4 sm:mx-0">
          <div className="grid grid-cols-1 lg:grid-cols-3 gap-10 sm:gap-6 lg:gap-8">
            <div className="lg:col-span-2">
              <div className="flex items-center justify-between mb-6 px-4 sm:px-0">
                <div>
                  <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 mb-2">
                    Featured
                  </h2>
                  <div className="w-20 h-1.5 bg-gradient-to-r from-primary-600 to-primary-400 rounded-full"></div>
                </div>
              </div>
              <NewsCard 
                article={featuredArticle} 
                variant="hero" 
                priority="high"
                isFeaturedHero={true}
                isFirstInCategory={true}
                showCategory={true}
              />
            </div>
            
            {/* Sidebar Ad */}
            <div className="px-4 sm:px-0">
              {sidebarAd && (
                <div className="sticky top-24">
                  <div className="bg-gray-50 rounded-lg p-1 border-2 border-gray-200">
                    <AdBanner ad={sidebarAd} placement="landing" />
                  </div>
                </div>
              )}
            </div>
          </div>
        </section>
      )}

      {/* Banner Ad 1 */}
      {featuredAds[0] && (
        <section className="mb-10 md:mb-16">
          <div className="bg-gradient-to-r from-gray-50 via-white to-gray-50 rounded-lg border-2 border-gray-200">
            <AdBanner ad={featuredAds[0]} placement="landing" />
          </div>
        </section>
      )}

      {/* Category Navigation */}
      {categories.length > 1 && (
        <section className="mb-8">
          <CategoryNavigation
            categories={categories}
            currentCategoryIndex={currentCategoryIndex}
            onCategoryChange={handleCategoryChange}
          />
        </section>
      )}

      {/* Category Sections */}
      <div className="space-y-10 md:space-y-20">
        {categories.map((category, categoryIndex) => {
          const paginatedArticles = getPaginatedArticles(category.slug);
          const totalPages = getTotalPages(category.slug);
          const currentPage = currentPages.get(category.slug) || 1;
          
          if (paginatedArticles.length === 0) return null;

          const layoutConfig = getLayoutConfig(categoryIndex);

          return (
            <React.Fragment key={category.id}>
              <section 
                className="scroll-mt-20"
                data-category={category.slug}
              >
                <div className="w-full">
                  {/* Category Header */}
                  <div className="flex items-center justify-between mb-8">
                    <div className="flex-1">
                      <div className="flex items-center space-x-3 mb-2">
                        <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 capitalize">
                          {category.name}
                        </h2>
                        <span className="hidden sm:inline-block px-3 py-1 bg-gray-100 text-gray-600 text-sm font-medium rounded-full">
                          {categoryArticles.get(category.slug)?.length || 0} articles
                        </span>
                      </div>
                      <div className="w-20 h-1.5 bg-gradient-to-r from-primary-600 to-primary-400 rounded-full"></div>
                    </div>
                    <Link
                      to={`/category/${category.slug}`}
                      className="group flex items-center space-x-2 text-primary-600 hover:text-primary-700 font-semibold text-sm md:text-base transition-colors"
                    >
                      <span>Explore all</span>
                      <svg className="w-5 h-5 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2.5} d="M9 5l7 7-7 7" />
                      </svg>
                    </Link>
                  </div>

                  {/* Category Content */}
                  <div className="w-full mb-8">
                    {renderCategoryLayout(layoutConfig, paginatedArticles)}
                  </div>

                  {/* Pagination */}
                  {totalPages > 1 && (
                    <div className="flex justify-center mt-8">
                      <Pagination
                        currentPage={currentPage}
                        totalPages={totalPages}
                        onPageChange={(page) => handlePageChange(category.slug, page)}
                      />
                    </div>
                  )}
                </div>
              </section>

              {/* Banner Ad 2 after 3rd category */}
              {categoryIndex === 2 && featuredAds[1] && (
                <section className="w-full my-10 md:my-12">
                  <div className="bg-gradient-to-r from-gray-50 via-white to-gray-50 rounded-lg p-1 border-2 border-gray-200">
                    <AdBanner ad={featuredAds[1]} placement="landing" />
                  </div>
                </section>
              )}
            </React.Fragment>
          );
        })}
      </div>

      {/* Newsletter Section */}
      <section className="mt-16 md:mt-24">
        <div className="relative bg-gradient-to-br from-primary-50 via-white to-primary-50/30 rounded-3xl overflow-hidden shadow-xl border border-primary-100">
          <div className="absolute inset-0 bg-grid-primary/[0.03] bg-[size:20px_20px]"></div>
          <div className="relative px-6 py-10 sm:px-8 sm:py-12 md:px-12 md:py-16">
            <div className="max-w-2xl mx-auto text-center">
              <div className="inline-flex items-center space-x-2 mb-4 px-4 py-2 bg-primary-100 text-primary-700 rounded-full text-sm font-semibold">
                <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                  <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                </svg>
                <span>Stay Informed</span>
              </div>
              
              <h2 className="text-3xl sm:text-4xl md:text-5xl font-bold text-gray-900 mb-6">
                Never Miss a Story
              </h2>
              <p className="text-lg md:text-xl text-gray-600 mb-8 leading-relaxed">
                Get the latest news and exclusive insights delivered straight to your inbox.
              </p>
              
              <form className="flex flex-col sm:flex-row gap-3 md:gap-4 max-w-lg mx-auto">
                <input
                  type="email"
                  placeholder="Enter your email address"
                  className="flex-1 px-5 md:px-6 py-3 md:py-4 text-base border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all bg-white shadow-sm"
                  required
                />
                <button
                  type="submit"
                  className="px-6 md:px-8 py-3 md:py-4 bg-primary-600 text-white text-base font-semibold rounded-xl hover:bg-primary-700 transition-all duration-300 shadow-lg hover:shadow-xl"
                >
                  Subscribe
                </button>
              </form>
              
              <p className="text-sm text-gray-500 mt-6">
                By subscribing, you agree to our <Link to="/privacy" className="text-primary-600 hover:underline">Privacy Policy</Link>.
              </p>
            </div>
          </div>
        </div>
      </section>
    </div>
  );
};

export default LandingPage;
I want it to be seemless for the user to navigate to these pages by calling the right backend endpoint: this is what i already have,build upon it:import { type Article, type Category, type ArticleFilters } from '../types/news';
import { categoryService } from '../services/news/categoryService';
import { articleService } from '../services/news/articleService';

/**
 * DataService - Safe, non-recursive data layer with caching
 */
class DataService {
  private static instance: DataService | null = null;

  // Caches
  private categoriesCache: { data: Category[]; fetchedAt: number } | null = null;
  private articlesCache: Map<string, { data: Article[]; fetchedAt: number }> = new Map();

  // Cache TTL (5 minutes)
  private readonly DEFAULT_TTL = 1000 * 60 * 5;

  // Static fallback categories
  private staticCategories: Category[] = [
    { id: '1', name: 'General', slug: 'general', description: 'General news and current events', color: 'bg-gray-500' },
    { id: '2', name: 'Technology', slug: 'technology', description: 'Latest in tech and innovation', color: 'bg-blue-500' },
    { id: '3', name: 'Business', slug: 'business', description: 'Financial markets and business news', color: 'bg-green-500' },
    { id: '4', name: 'Sports', slug: 'sports', description: 'Sports news and updates', color: 'bg-orange-500' },
    { id: '5', name: 'Health', slug: 'health', description: 'Health and wellness news', color: 'bg-purple-500' },
    { id: '6', name: 'Science', slug: 'science', description: 'Scientific discoveries and research', color: 'bg-indigo-500' }
  ];

  // Mock articles for fallback/demo
  private mockArticles: Article[] = [
    {
      id: '1',
      title: 'The Future of Artificial Intelligence in 2024',
      summary: 'Exploring the latest advancements in AI and machine learning that are shaping our future.',
      content: 'Artificial intelligence continues to evolve at an unprecedented pace. New breakthroughs in machine learning algorithms and neural networks are enabling applications we could only dream of a few years ago.',
      author: 'Tech Insights',
      publishedAt: new Date().toISOString(),
      imageUrl: 'https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg',
      category: 'technology',
      readTime: 4,
      tags: ['AI', 'Machine Learning', 'Technology']
    },
    {
      id: '2',
      title: 'Global Markets Show Strong Recovery Signs',
      summary: 'Economic indicators point towards sustained growth in major markets worldwide.',
      content: 'Financial markets around the world are showing promising signs of recovery as economic indicators improve and investor confidence returns.',
      author: 'Financial Times',
      publishedAt: new Date(Date.now() - 86400000).toISOString(), // 1 day ago
      imageUrl: 'https://images.pexels.com/photos/210607/pexels-photo-210607.jpeg',
      category: 'business',
      readTime: 3,
      tags: ['Markets', 'Economy', 'Finance']
    },
    {
      id: '3',
      title: 'Championship Finals Set After Thrilling Semis',
      summary: 'Underdog team advances to finals in stunning upset victory that shocked fans.',
      content: 'In a dramatic turn of events, the underdog team secured their spot in the championship finals with a performance that will be remembered for years to come.',
      author: 'Sports Network',
      publishedAt: new Date(Date.now() - 172800000).toISOString(), // 2 days ago
      imageUrl: 'https://images.pexels.com/photos/46798/the-ball-stadion-football-the-pitch-46798.jpeg',
      category: 'sports',
      readTime: 2,
      tags: ['Championship', 'Sports', 'Victory']
    },
    {
      id: '4',
      title: 'Breakthrough in Renewable Energy Storage',
      summary: 'New battery technology promises to revolutionize how we store solar and wind energy.',
      content: 'Scientists have developed a new battery technology that could solve one of renewable energy\'s biggest challenges: reliable storage for times when the sun isn\'t shining and the wind isn\'t blowing.',
      author: 'Science Daily',
      publishedAt: new Date(Date.now() - 259200000).toISOString(), // 3 days ago
      imageUrl: 'https://images.pexels.com/photos/256262/pexels-photo-256262.jpeg',
      category: 'science',
      readTime: 5,
      tags: ['Energy', 'Innovation', 'Research']
    }
  ];

  private constructor() {}

  static getInstance(): DataService {
    if (!DataService.instance) {
      DataService.instance = new DataService();
    }
    return DataService.instance;
  }

  // ----------------------
  // Categories
  // ----------------------

  async getCategories(options?: { forceRefresh?: boolean }): Promise<Category[]> {
    const force = options?.forceRefresh ?? false;

    if (!force && this.categoriesCache) {
      const age = Date.now() - this.categoriesCache.fetchedAt;
      if (age < this.DEFAULT_TTL) {
        return this.categoriesCache.data;
      }
    }

    try {
      const cats = await categoryService.getCategories();
      const safeCats = Array.isArray(cats) && cats.length > 0 ? cats : this.staticCategories;
      this.categoriesCache = { data: safeCats, fetchedAt: Date.now() };
      return safeCats;
    } catch (err) {
      console.error('DataService.getCategories: failed to fetch categories, using fallback', err);
      if (this.categoriesCache) return this.categoriesCache.data;
      return this.staticCategories;
    }
  }

  getCategoriesSync(): Category[] {
    try {
      if (this.categoriesCache) return this.categoriesCache.data;
      return this.staticCategories;
    } catch (err) {
      console.error('DataService.getCategoriesSync: unexpected error', err);
      return this.staticCategories;
    }
  }

  async getCategory(slug: string): Promise<Category | undefined> {
    const cats = await this.getCategories();
    return cats.find((c) => c.slug === slug);
  }

  async getPopularCategories(limit: number = 6): Promise<Category[]> {
    try {
      const cats = await this.getCategories();
      return cats.slice(0, limit);
    } catch (err) {
      console.error('DataService.getPopularCategories failed', err);
      return this.staticCategories.slice(0, limit);
    }
  }

  // ----------------------
  // Articles
  // ----------------------

  async getArticles(filters: ArticleFilters = {}, options?: { forceRefresh?: boolean }): Promise<Article[]> {
    const cacheKey = this.generateCacheKey('articles', filters);
    const force = options?.forceRefresh ?? false;

    const cached = this.articlesCache.get(cacheKey);
    if (!force && cached && Date.now() - cached.fetchedAt < this.DEFAULT_TTL) {
      return cached.data;
    }

    try {
      const articles = await articleService.getArticles(filters);
      const normalized = Array.isArray(articles) ? articles : [];
      this.articlesCache.set(cacheKey, { data: normalized, fetchedAt: Date.now() });
      return normalized;
    } catch (err) {
      console.error('DataService.getArticles: failed to fetch, using fallback', err);
      
      // Return mock articles as fallback filtered by category if specified
      if (filters.category) {
        return this.mockArticles.filter(article => article.category === filters.category).slice(0, filters.limit || 10);
      }
      
      if (cached) return cached.data;
      return this.mockArticles.slice(0, filters.limit || 10);
    }
  }

  async getArticleById(id: string): Promise<Article | null> {
    try {
      const art = await articleService.getArticle(id);
      return art ?? null;
    } catch (err) {
      console.error(`DataService.getArticleById(${id}) failed`, err);
      // Return mock article as fallback
      return this.mockArticles.find(article => article.id === id) || null;
    }
  }

  async getArticlesByCategory(category: string, limit?: number, options?: { forceRefresh?: boolean }): Promise<Article[]> {
    const filters: ArticleFilters = { category, limit };
    return this.getArticles(filters, options);
  }

  async getLatestArticles(limit: number = 10, options?: { forceRefresh?: boolean }): Promise<Article[]> {
    const filters: ArticleFilters = { limit, sortBy: 'publishedAt', order: 'desc' };
    return this.getArticles(filters, options);
  }

  async getTrendingArticles(limit: number = 5): Promise<Article[]> {
    try {
      const arts = await articleService.getTrendingArticles(limit);
      return Array.isArray(arts) ? arts : [];
    } catch (err) {
      console.error('DataService.getTrendingArticles failed', err);
      return this.getLatestArticles(limit);
    }
  }

  async getFeaturedArticles(): Promise<Article[]> {
    try {
      const arts = await articleService.getFeaturedArticles();
      return Array.isArray(arts) ? arts : [];
    } catch (err) {
      console.error('DataService.getFeaturedArticles failed', err);
      return this.mockArticles.filter(article => article.category === 'technology').slice(0, 3);
    }
  }

  async searchArticles(query: string): Promise<Article[]> {
    try {
      const arts = await articleService.searchArticles(query);
      return Array.isArray(arts) ? arts : [];
    } catch (err) {
      console.error('DataService.searchArticles failed', err);
      return this.mockArticles.filter(article => 
        article.title.toLowerCase().includes(query.toLowerCase()) ||
        article.summary.toLowerCase().includes(query.toLowerCase())
      );
    }
  }

  async getRelatedArticles(currentArticle: Article, limit: number = 3): Promise<Article[]> {
    try {
      const arts = await articleService.getRelatedArticles(currentArticle.id, limit);
      return Array.isArray(arts) ? arts : [];
    } catch (err) {
      console.error('DataService.getRelatedArticles failed', err);
      return this.mockArticles
        .filter(article => article.id !== currentArticle.id && article.category === currentArticle.category)
        .slice(0, limit);
    }
  }

  async recordArticleView(articleId: string): Promise<void> {
    try {
      await articleService.recordView(articleId);
    } catch (err) {
      console.error(`DataService.recordArticleView(${articleId}) failed`, err);
    }
  }

  // ----------------------
  // Cache management
  // ----------------------

  clearCache(): void {
    this.categoriesCache = null;
    this.articlesCache.clear();
  }

  invalidateArticlesCache(filters: ArticleFilters = {}): void {
    const key = this.generateCacheKey('articles', filters);
    this.articlesCache.delete(key);
  }

  // ----------------------
  // Utilities
  // ----------------------

  private generateCacheKey(prefix: string, filters: ArticleFilters = {}): string {
    const params = Object.entries(filters)
      .filter(([_, v]) => v !== undefined && v !== null && v !== '')
      .map(([k, v]) => `${k}=${String(v)}`)
      .sort()
      .join('&');
    return params ? `${prefix}?${params}` : prefix;
  }
}

// Singleton instance
export const dataService = DataService.getInstance();

// Synchronous categories export for immediate use
export const categories = dataService.getCategoriesSync();

// Named exports for compatibility
export const getArticlesByCategory = (category: string, limit?: number) => 
  dataService.getArticlesByCategory(category, limit);

export const getArticleById = (id: string) => 
  dataService.getArticleById(id);

export const getRelatedArticles = (article: Article, limit?: number) => 
  dataService.getRelatedArticles(article, limit);

export const searchArticles = (query: string) => 
  dataService.searchArticles(query);

export const getCategories = () => dataService.getCategories();
export const getCategoriesSync = () => dataService.getCategoriesSync();
export const getCategory = (slug: string) => dataService.getCategory(slug);
export const getPopularCategories = (limit?: number) => dataService.getPopularCategories(limit);
export const getArticles = (filters?: ArticleFilters) => dataService.getArticles(filters);
export const getLatestArticles = (limit?: number) => dataService.getLatestArticles(limit);
export const getTrendingArticles = (limit?: number) => dataService.getTrendingArticles(limit);
export const getFeaturedArticles = () => dataService.getFeaturedArticles();
export const recordArticleView = (id: string) => dataService.recordArticleView(id);
export const clearCache = () => dataService.clearCache();

export default dataService;
import {type ApiResponse } from '../../types/news'

const BASE_URL = 'http://127.0.0.1:8000/api/v1';
const API_TOKEN = '8|o0MM5b8VLbzndqREiW4VJHYG3ThxE554Z9F67q9q8ce7b00e';

class ApiClient {
  private headers: HeadersInit;

  constructor() {
    this.headers = {
      'Content-Type': 'application/json',
      'Accept': 'application/json',
      'Authorization': `Bearer ${API_TOKEN}`,
    };
  }

  async get<T>(endpoint: string, params?: Record<string, any>): Promise<T> {
    const url = this.buildUrl(endpoint, params);
    return this.fetch<T>(url, { method: 'GET' });
  }

  async post<T>(endpoint: string, data?: any): Promise<T> {
    const url = `${BASE_URL}${endpoint}`;
    return this.fetch<T>(url, {
      method: 'POST',
      body: data ? JSON.stringify(data) : undefined,
    });
  }

  async put<T>(endpoint: string, data: any): Promise<T> {
    const url = `${BASE_URL}${endpoint}`;
    return this.fetch<T>(url, {
      method: 'PUT',
      body: JSON.stringify(data),
    });
  }

  async delete<T>(endpoint: string): Promise<T> {
    const url = `${BASE_URL}${endpoint}`;
    return this.fetch<T>(url, { method: 'DELETE' });
  }

  private async fetch<T>(url: string, options: RequestInit = {}): Promise<T> {
    try {
      const response = await fetch(url, {
        headers: this.headers,
        ...options,
      });

      if (!response.ok) {
        throw new Error(`API Error: ${response.status} ${response.statusText}`);
      }

      const data: ApiResponse<T> = await response.json();
      
      if (!data.success) {
        throw new Error(data.message);
      }

      return data.data;
    } catch (error) {
      console.error('API Fetch Error:', error);
      throw error;
    }
  }

  private buildUrl(endpoint: string, params?: Record<string, any>): string {
    const url = new URL(`${BASE_URL}${endpoint}`);
    
    if (params) {
      Object.keys(params).forEach(key => {
        if (params[key] !== undefined && params[key] !== null) {
          url.searchParams.append(key, params[key].toString());
        }
      });
    }
    
    return url.toString();
  }
}

export const apiClient = new ApiClient();
import { apiClient } from './client';
import { type ApiArticle,type ApiCategory, type ArticleFilters,} from '../../types/news'

export const apiEndpoints = {
  // Categories
  categories: {
    list: () => apiClient.get<ApiCategory[]>('/categories'),
    get: (slug: string) => apiClient.get<ApiCategory>(`/categories/${slug}`),
  },

  // Articles
  articles: {
    list: (params?: ArticleFilters) => 
      apiClient.get<ApiArticle[]>(`/articles`, params),
    
    get: (id: string) => 
      apiClient.get<ApiArticle>(`/articles/${id}`),
    
    recordView: (id: string) => 
      apiClient.post(`/articles/${id}/view`),
    
    related: (id: string) => 
      apiClient.get<ApiArticle[]>(`/articles/${id}/related`),
  },

  // News
  news: {
    latest: (limit?: number) => 
      apiClient.get<ApiArticle[]>(`/news/latest`, { limit }),
    
    trending: (limit?: number) => 
      apiClient.get<ApiArticle[]>(`/news/trending`, { limit }),
    
    featured: () => 
      apiClient.get<ApiArticle[]>(`/news/featured`),
    
    byCategory: (category: string, limit?: number) => 
      apiClient.get<ApiArticle[]>(`/news/by-category/${category}`, { limit }),
    
    bySource: (source: string, limit?: number) => 
      apiClient.get<ApiArticle[]>(`/news/by-source/${source}`, { limit }),
    
    search: (query: string, limit?: number) => 
      apiClient.get<ApiArticle[]>(`/news/search`, { q: query, limit }),
    
    categorized: (categories?: string[], limit?: number) => 
      apiClient.get<ApiArticle[]>(`/news/categorized`, { 
        categories: categories?.join(','), 
        limit 
      }),
  },

  // MediaStack
  mediastack: {
    testConnection: () => 
      apiClient.post(`/mediastack/test-connection`),
    
    status: () => 
      apiClient.get(`/mediastack/status`),
    
    usageStats: () => 
      apiClient.get(`/mediastack/usage-stats`),
  },
};
import { apiEndpoints } from '../api/endpoints';
import { type Article, type ApiArticle,type  ArticleFilters } from '../../types/news';

export class ArticleService {
  async getArticles(filters: ArticleFilters = {}): Promise<Article[]> {
    const apiArticles = await apiEndpoints.articles.list(filters);
    return apiArticles.map(article => this.formatArticle(article));
  }

  async getArticle(id: string): Promise<Article | null> {
    try {
      const apiArticle = await apiEndpoints.articles.get(id);
      return this.formatArticle(apiArticle);
    } catch (error) {
      console.error('Error fetching article:', error);
      return null;
    }
  }

  async getLatestArticles(limit: number = 10): Promise<Article[]> {
    const apiArticles = await apiEndpoints.news.latest(limit);
    return apiArticles.map(article => this.formatArticle(article));
  }

  async getTrendingArticles(limit: number = 5): Promise<Article[]> {
    const apiArticles = await apiEndpoints.news.trending(limit);
    return apiArticles.map(article => this.formatArticle(article));
  }

  async getFeaturedArticles(): Promise<Article[]> {
    const apiArticles = await apiEndpoints.news.featured();
    return apiArticles.map(article => this.formatArticle(article));
  }

  async getArticlesByCategory(category: string, limit?: number): Promise<Article[]> {
  try {
    const articles = await articleService.getArticlesByCategory(category, limit);
    return Array.isArray(articles) ? articles : [];
  } catch (error) {
    console.error(`Error getting articles for category ${category}:`, error);
    return [];
  }
}

  async getArticlesBySource(source: string, limit?: number): Promise<Article[]> {
    const apiArticles = await apiEndpoints.news.bySource(source, limit);
    return apiArticles.map(article => this.formatArticle(article));
  }

  async searchArticles(query: string, limit?: number): Promise<Article[]> {
    const apiArticles = await apiEndpoints.news.search(query, limit);
    return apiArticles.map(article => this.formatArticle(article));
  }

  async getRelatedArticles(articleId: string, limit: number = 3): Promise<Article[]> {
    try {
      const apiArticles = await apiEndpoints.articles.related(articleId);
      return apiArticles.map(article => this.formatArticle(article)).slice(0, limit);
    } catch (error) {
      console.error('Error fetching related articles:', error);
      return [];
    }
  }

  async recordView(articleId: string): Promise<void> {
    try {
      await apiEndpoints.articles.recordView(articleId);
    } catch (error) {
      console.error('Error recording view:', error);
    }
  }

  private formatArticle(apiArticle: ApiArticle): Article {
    const wordCount = apiArticle.content ? apiArticle.content.split(/\s+/).length : 100;
    const readTime = Math.max(1, Math.ceil(wordCount / 200));

    const summary = apiArticle.description || 
                   apiArticle.meta_description || 
                   apiArticle.excerpt || 
                   this.createSummary(apiArticle.title);

    const content = apiArticle.content || 
                   apiArticle.description || 
                   apiArticle.summary || 
                   '';

    const tags = this.parseTags(apiArticle.tags, apiArticle.category);

    return {
      id: apiArticle.id.toString(),
      title: apiArticle.title,
      summary: summary,
      content: content,
      author: apiArticle.author || 'Unknown Author',
      publishedAt: apiArticle.published_at,
      imageUrl: apiArticle.image_url || this.getFallbackImage(apiArticle.category),
      category: apiArticle.category,
      readTime: readTime,
      tags: tags,
      url: apiArticle.url,
      source: apiArticle.source || undefined,
      viewCount: apiArticle.view_count,
      isFeatured: apiArticle.is_featured,
    };
  }

  private parseTags(tags: string | null, category: string): string[] {
    if (!tags) {
      return [category];
    }

    try {
      if (typeof tags === 'string') {
        const parsed = JSON.parse(tags);
        return Array.isArray(parsed) ? parsed : [category];
      }
      return Array.isArray(tags) ? tags : [category];
    } catch {
      return tags.split(',').map(tag => tag.trim()).filter(tag => tag.length > 0);
    }
  }

  private createSummary(title: string): string {
    return `${title}. Read more for the full story.`;
  }

  private getFallbackImage(category: string): string {
    const fallbackImages: { [key: string]: string } = {
      'world': 'https://images.pexels.com/photos/87651/earth-blue-planet-globe-planet-87651.jpeg',
      'business': 'https://images.pexels.com/photos/210607/pexels-photo-210607.jpeg',
      'technology': 'https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg',
      'sports': 'https://images.pexels.com/photos/46798/the-ball-stadion-football-the-pitch-46798.jpeg',
      'health': 'https://images.pexels.com/photos/40568/medical-appointment-doctor-healthcare-40568.jpeg',
      'science': 'https://images.pexels.com/photos-256262/pexels-photo-256262.jpeg',
      'general': 'https://images.pexels.com/photos/158651/news-newsletter-newspaper-information-158651.jpeg',
    };

    return fallbackImages[category] || 'https://images.pexels.com/photos/158651/news-newsletter-newspaper-information-158651.jpeg';
  }
}

export const articleService = new ArticleService();
import { apiEndpoints } from '../api/endpoints';
import { type Category, type ApiCategory, type ApiArticle } from  '../../types/news';

export class CategoryService {
  private colorMap: Map<string, string>;

  constructor() {
    this.colorMap = new Map([
      ['world', 'bg-red-500'],
      ['business', 'bg-green-500'],
      ['technology', 'bg-blue-500'],
      ['sports', 'bg-orange-500'],
      ['health', 'bg-purple-500'],
      ['science', 'bg-indigo-500'],
      ['general', 'bg-gray-500'],
      ['entertainment', 'bg-pink-500'],
      ['politics', 'bg-yellow-500'],
      ['environment', 'bg-emerald-500'],
      ['finance', 'bg-lime-500'],
      ['education', 'bg-cyan-500'],
    ]);
  }

  async getCategories(): Promise<Category[]> {
    try {
      const apiCategories = await apiEndpoints.categories.list();
      return apiCategories.map(cat => this.formatCategory(cat));
    } catch (error) {
      console.error('Failed to fetch categories, extracting from articles...', error);
      return this.extractCategoriesFromArticles();
    }
  }

  async extractCategoriesFromArticles(): Promise<Category[]> {
    try {
      const articles = await apiEndpoints.articles.list({ perPage: 100 });
      return this.buildCategoriesFromArticles(articles);
    } catch (error) {
      console.error('Failed to extract categories from articles:', error);
      return this.getFallbackCategories();
    }
  }

  private buildCategoriesFromArticles(articles: ApiArticle[]): Category[] {
    const categoryMap = new Map<string, { count: number; name: string }>();
    
    articles.forEach(article => {
      const categorySlug = article.category || 'general';
      const categoryName = article.category_model?.name || this.formatCategoryName(categorySlug);
      
      if (categoryMap.has(categorySlug)) {
        categoryMap.get(categorySlug)!.count++;
      } else {
        categoryMap.set(categorySlug, {
          count: 1,
          name: categoryName
        });
      }
    });

    const categories: Category[] = [];
    let idCounter = 1;
    
    for (const [slug, data] of categoryMap.entries()) {
      categories.push({
        id: (idCounter++).toString(),
        name: data.name,
        slug: slug,
        description: this.generateCategoryDescription(slug, data.name),
        color: this.getCategoryColor(slug),
        articleCount: data.count,
        isActive: true
      });
    }

    return categories.sort((a, b) => (b.articleCount || 0) - (a.articleCount || 0));
  }

  async getPopularCategories(limit: number = 6): Promise<Category[]> {
    const categories = await this.getCategories();
    return categories
      .sort((a, b) => (b.articleCount || 0) - (a.articleCount || 0))
      .slice(0, limit);
  }

  private formatCategory(apiCategory: ApiCategory): Category {
    return {
      id: apiCategory.id.toString(),
      name: apiCategory.name || apiCategory.slug,
      slug: apiCategory.slug,
      description: apiCategory.description || `News category: ${apiCategory.slug}`,
      color: this.getCategoryColor(apiCategory.slug),
      isActive: apiCategory.is_active,
    };
  }

  private formatCategoryName(slug: string): string {
    return slug.charAt(0).toUpperCase() + slug.slice(1);
  }

  private generateCategoryDescription(slug: string, name: string): string {
    const descriptions: { [key: string]: string } = {
      'world': 'Global news and international affairs',
      'business': 'Financial markets and business news',
      'technology': 'Latest in tech and innovation',
      'sports': 'Sports news and updates',
      'health': 'Health and wellness news',
      'science': 'Scientific discoveries and research',
      'general': 'General news and current events',
      'entertainment': 'Entertainment news and celebrity updates',
      'politics': 'Political news and government affairs',
      'environment': 'Environmental news and climate updates',
    };

    return descriptions[slug] || `Latest ${name} news and updates`;
  }

  private getCategoryColor(slug: string): string {
    if (this.colorMap.has(slug)) {
      return this.colorMap.get(slug)!;
    }

    const colors = [
      'bg-red-500', 'bg-blue-500', 'bg-green-500', 'bg-yellow-500', 
      'bg-purple-500', 'bg-pink-500', 'bg-indigo-500', 'bg-orange-500',
      'bg-teal-500', 'bg-cyan-500', 'bg-lime-500', 'bg-amber-500',
    ];

    let hash = 0;
    for (let i = 0; i < slug.length; i++) {
      hash = slug.charCodeAt(i) + ((hash << 5) - hash);
    }
    
    const index = Math.abs(hash) % colors.length;
    return colors[index];
  }

  private getFallbackCategories(): Category[] {
    return [
      {
        id: '1',
        name: 'General',
        slug: 'general',
        description: 'General news and current events',
        color: 'bg-gray-500',
        isActive: true
      }
    ];
  }
}

export const categoryService = new CategoryService();
import { type Article, type Category,type  ArticleFilters } from '../types/news';
import { categoryService } from './news/categoryService';
import { articleService } from './news/articleService';

class DataService {
  private categoriesCache: Category[] | null = null;
  private articlesCache: Map<string, Article[]> = new Map();

  // Categories
  async getCategories(): Promise<Category[]> {
    if (!this.categoriesCache) {
      this.categoriesCache = await categoryService.getCategories();
    }
    return this.categoriesCache;
  }

  async getCategory(slug: string): Promise<Category | undefined> {
    const categories = await this.getCategories();
    return categories.find(cat => cat.slug === slug);
  }

  async getPopularCategories(limit: number = 6): Promise<Category[]> {
    return categoryService.getPopularCategories(limit);
  }

  // Articles
  async getArticles(filters: ArticleFilters = {}): Promise<Article[]> {
    const cacheKey = this.generateCacheKey('articles', filters);
    
    if (!this.articlesCache.has(cacheKey)) {
      const articles = await articleService.getArticles(filters);
      this.articlesCache.set(cacheKey, articles);
    }
    
    return this.articlesCache.get(cacheKey) || [];
  }

  async getArticleById(id: string): Promise<Article | null> {
    return articleService.getArticle(id);
  }

  async getArticlesByCategory(category: string, limit?: number): Promise<Article[]> {
    return articleService.getArticlesByCategory(category, limit);
  }

  async getLatestArticles(limit: number = 10): Promise<Article[]> {
    return articleService.getLatestArticles(limit);
  }

  async getTrendingArticles(limit: number = 5): Promise<Article[]> {
    return articleService.getTrendingArticles(limit);
  }

  async getFeaturedArticles(): Promise<Article[]> {
    return articleService.getFeaturedArticles();
  }

  async searchArticles(query: string): Promise<Article[]> {
    return articleService.searchArticles(query);
  }

  async getRelatedArticles(currentArticle: Article, limit: number = 3): Promise<Article[]> {
    return articleService.getRelatedArticles(currentArticle.id, limit);
  }

  async recordArticleView(articleId: string): Promise<void> {
    await articleService.recordView(articleId);
  }

  // Cache management
  clearCache(): void {
    this.categoriesCache = null;
    this.articlesCache.clear();
  }

  private generateCacheKey(prefix: string, filters: ArticleFilters = {}): string {
    const params = Object.entries(filters)
      .filter(([_, value]) => value !== undefined && value !== null)
      .map(([key, value]) => `${key}=${value}`)
      .join('&');
    
    return params ? `${prefix}?${params}` : prefix;
  }
}

export const dataService = new DataService();

// Export legacy functions for easy migration
export const getArticlesByCategory = dataService.getArticlesByCategory.bind(dataService);
export const getArticleById = dataService.getArticleById.bind(dataService);
export const getRelatedArticles = dataService.getRelatedArticles.bind(dataService);
export const searchArticles = dataService.searchArticles.bind(dataService);
We are not hard coding anything,everything should be dynamic and should come from the database or within the frontend if stored,we should show loading slates.
import React, { useState, useEffect } from 'react';
import { Link, useLocation, useNavigate } from 'react-router-dom';
import { dataService } from '../data/dataService'
import { type Category } from '../types/news'; // Import the Category type
import SearchBar from './SearchBar';

const Navbar: React.FC = () => {
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const [categories, setCategories] = useState<Category[]>([]); // State for categories
  const [loading, setLoading] = useState(true);
  const location = useLocation();
  const navigate = useNavigate();

  // Load categories from API
  useEffect(() => {
    const loadCategories = async () => {
      try {
        setLoading(true);
        const categoriesData = await dataService.getCategories();
        setCategories(categoriesData);
      } catch (error) {
        console.error('Failed to load categories:', error);
        setCategories([]); // Fallback to empty array
      } finally {
        setLoading(false);
      }
    };

    loadCategories();
  }, []);

  // Prevent body scroll when menu is open
  useEffect(() => {
    if (isMobileMenuOpen) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'unset';
    }
    return () => {
      document.body.style.overflow = 'unset';
    };
  }, [isMobileMenuOpen]);

  const handleSearch = (query: string) => {
    if (query.trim()) {
      navigate(`/search?q=${encodeURIComponent(query.trim())}`);
      setIsMobileMenuOpen(false);
    }
  };

  const isActiveRoute = (path: string) => {
    return location.pathname === path;
  };

  // Show loading state
  if (loading) {
    return (
      <nav className="bg-white shadow-lg sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            <div className="flex-shrink-0">
              <Link to="/" className="text-2xl font-bold text-gray-800">
                DefinePress
              </Link>
            </div>
            <div className="hidden md:block">
              <div className="animate-pulse flex space-x-4">
                {[...Array(6)].map((_, i) => (
                  <div key={i} className="h-6 w-20 bg-gray-200 rounded"></div>
                ))}
              </div>
            </div>
          </div>
        </div>
      </nav>
    );
  }

  return (
    <nav className="bg-white shadow-lg sticky top-0 z-50">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center h-16">
          {/* Logo */}
          <div className="flex-shrink-0">
            <Link
              to="/"
              className="relative inline-block text-3xl font-extrabold tracking-tight text-transparent bg-clip-text 
               bg-gradient-to-r from-blue-400 via-blue-500 to-blue-700 
               hover:from-blue-500 hover:via-blue-600 hover:to-blue-800 
               transition-all duration-300"
            >
              Define<span className="text-gray-800">Press</span>
              <span className="absolute -bottom-1 left-0 w-full h-0.5 bg-gradient-to-r from-blue-400 to-blue-700 scale-x-0 hover:scale-x-100 origin-left transition-transform duration-300"></span>
            </Link>
          </div>

          {/* Desktop Navigation */}
          <div className="hidden md:block">
            <div className="ml-10 flex items-baseline space-x-4">
              <Link
                to="/"
                className={`px-3 py-2 rounded-md text-sm font-medium transition-colors ${
                  isActiveRoute('/') 
                    ? 'text-primary-600 bg-primary-50' 
                    : 'text-gray-700 hover:text-primary-600 hover:bg-gray-100'
                }`}
              >
                Home
              </Link>
              {categories.map((category) => (
                <Link
                  key={category.id}
                  to={`/category/${category.slug}`}
                  className={`px-3 py-2 rounded-md text-sm font-medium transition-colors capitalize ${
                    isActiveRoute(`/category/${category.slug}`)
                      ? 'text-primary-600 bg-primary-50'
                      : 'text-gray-700 hover:text-primary-600 hover:bg-gray-100'
                  }`}
                >
                  {category.name}
                </Link>
              ))}
            </div>
          </div>

          {/* Search Bar - Desktop */}
          <div className="hidden md:block">
            <SearchBar onSearch={handleSearch} placeholder="Search news..." showButton={false} />
          </div>

          {/* Mobile menu button */}
          <div className="md:hidden">
            <button
              onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
              className="inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-primary-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 transition-colors"
              aria-expanded={isMobileMenuOpen}
              aria-label="Toggle navigation menu"
            >
              <span className="sr-only">Open main menu</span>
              {!isMobileMenuOpen ? (
                <svg className="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                </svg>
              ) : (
                <svg className="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                </svg>
              )}
            </button>
          </div>
        </div>
      </div>

      {/* Mobile Navigation Menu */}
      {isMobileMenuOpen && (
        <>
          {/* Backdrop */}
          <div 
            className="md:hidden fixed inset-0 z-40 bg-gray-900/20 backdrop-blur-sm animate-fadeIn"
            onClick={() => setIsMobileMenuOpen(false)}
            aria-hidden="true"
          />
          
          {/* Sliding Menu Panel */}
          <div className="md:hidden fixed inset-y-0 right-0 z-50 w-full max-w-sm bg-white shadow-2xl animate-slideInRight">
            <div className="flex flex-col h-full">
              {/* Header Section */}
              <div className="flex items-center justify-between px-6 py-5">
                <div>
                  <h2 className="text-lg font-bold text-gray-900">Menu</h2>
                </div>
                <button
                  onClick={() => setIsMobileMenuOpen(false)}
                  className="p-2 rounded-lg text-gray-400 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500 transition-all duration-200"
                  aria-label="Close menu"
                >
                  <svg className="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>

              {/* Scrollable Content */}
              <div className="flex-1 overflow-y-auto pl-10 py-1 w-full">
                {/* Search Section */}
                <div className="mb-2">
                  <SearchBar 
                    onSearch={handleSearch} 
                    placeholder="Search news..." 
                    showButton={true}
                  />
                </div>

                {/* Navigation Links */}
                <div>
                  <nav className="space-y-1">
                    <Link
                      to="/"
                      className={`group flex items-center px-4 mt-6 py-1 rounded-lg text-base font-medium transition-all duration-200 ${
                        isActiveRoute('/')
                          ? 'text-primary-600 bg-primary-50 text-blue-500'
                          : 'text-gray-700 hover:text-gray-900 hover:bg-gray-50 border-l-4 border-transparent'
                      }`}
                      onClick={() => setIsMobileMenuOpen(false)}
                    >
                      <svg 
                        className={`w-5 h-5 mr-3 ${
                          isActiveRoute('/') ? 'text-primary-600' : 'text-gray-400'
                        }`}
                        fill="none" 
                        stroke="currentColor" 
                        viewBox="0 0 24 24"
                      >
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                      </svg>
                      <span>Home</span>
                    </Link>                  

                    {categories.map((category, index) => {
                      const isActive = isActiveRoute(`/category/${category.slug}`);
                      const categoryIcons = [
                        'M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z', // Technology
                        'M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z', // Business
                        'M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z', // Sports
                        'M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z', // Science
                        'M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z', // Entertainment
                        'M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z' // World
                      ];
                      
                      return (
                        <Link
                          key={category.id}
                          to={`/category/${category.slug}`}
                          className={`group flex items-center px-4 py-3 rounded-lg text-base font-medium capitalize transition-all duration-200 ${
                            isActive
                              ? 'text-primary-600 bg-primary-50 text-blue-500'
                              : 'text-gray-700 hover:text-gray-900 hover:bg-gray-50 border-l-4 border-transparent'
                          }`}
                          onClick={() => setIsMobileMenuOpen(false)}
                        >
                          <svg 
                            className={`w-5 h-5 mr-3 ${
                              isActive ? 'text-primary-600' : 'text-gray-400'
                            }`}
                            fill="none" 
                            stroke="currentColor" 
                            viewBox="0 0 24 24"
                          >
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d={categoryIcons[index % categoryIcons.length]} />
                          </svg>
                          <span>{category.name}</span>
                        </Link>
                      );
                    })}
                  </nav>
                </div>
              </div>

              {/* Footer Section */}
              <div className="px-6 py-4 border-t border-gray-100">
                <div className="flex items-center justify-between text-sm">
                  <span className="text-gray-500 text-xs">
                    Â© {new Date().getFullYear()} DefinePress
                  </span>
                  <div className="flex items-center space-x-4">
                    {/* Social icons */}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </>
      )}

      {/* Add custom animations */}
      <style>{`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes slideInRight {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        
        .animate-fadeIn {
          animation: fadeIn 0.2s ease-out;
        }
        
        .animate-slideInRight {
          animation: slideInRight 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
      `}</style>
    </nav>
  );
};

export default Navbar;
Give me all the files and everything should integrate well and should be seemless.
I'll help you create a seamless integration between your frontend and backend. Let me build upon your existing code with proper API integration, loading states, and error handling.

Using Tool
|
Think
The user wants to integrate their React frontend with the Laravel backend API for a news/articles platform. They have: 1. Backend endpoints for: - News (latest, trending, featured, by-category, by-source, search) - Articles (list, get by id, related, record view) - Categories 2. Frontend pages: - Landing page - Article page - Category page - Search page 3. Existing services: - dataService (main service layer) - articleService - categoryService - apiClient Key requirements: - Everything should be dynamic (no hardcoding) - Show loading states - Seamless navigation - Proper error handling - Cache management I need to: 1. Update the API client to properly handle errors and responses 2. Enhance the article service with better error handling 3. Enhance the category service with better error handling 4. Update dataService with loading states 5. Create loading skeleton components 6. Update the page components to handle loading/error states 7. Ensure proper TypeScript types 8. Add proper cache invalidation 9. Handle edge cases (no data, errors, etc.) Let me create comprehensive files that integrate everything properly.
View
I'll provide you with a complete, seamless integration. Here are all the necessary files:

1. Updated Types (src/types/news.ts)
Copy// API Response Types
export interface ApiResponse<T> {
  success: boolean;
  data: T;
  message?: string;
  meta?: {
    current_page?: number;
    last_page?: number;
    per_page?: number;
    total?: number;
  };
}

export interface ApiArticle {
  id: number;
  title: string;
  slug: string;
  summary?: string;
  description?: string;
  meta_description?: string;
  excerpt?: string;
  content?: string;
  author?: string;
  published_at: string;
  image_url?: string;
  category: string;
  category_model?: {
    id: number;
    name: string;
    slug: string;
  };
  tags?: string | string[] | null;
  url?: string;
  source?: string;
  view_count?: number;
  is_featured?: boolean;
  is_active?: boolean;
  created_at?: string;
  updated_at?: string;
}

export interface ApiCategory {
  id: number;
  name: string;
  slug: string;
  description?: string;
  is_active: boolean;
  created_at?: string;
  updated_at?: string;
}

// Frontend Types
export interface Article {
  id: string;
  title: string;
  summary: string;
  content: string;
  author: string;
  publishedAt: string;
  imageUrl: string;
  category: string;
  readTime: number;
  tags: string[];
  url?: string;
  source?: string;
  viewCount?: number;
  isFeatured?: boolean;
}

export interface Category {
  id: string;
  name: string;
  slug: string;
  description: string;
  color: string;
  articleCount?: number;
  isActive?: boolean;
}

export interface ArticleFilters {
  category?: string;
  limit?: number;
  page?: number;
  perPage?: number;
  sortBy?: 'publishedAt' | 'title' | 'viewCount';
  order?: 'asc' | 'desc';
  search?: string;
}

export interface Ad {
  id: string;
  title: string;
  imageUrl: string;
  clickUrl: string;
  placement: string;
}

// Loading States
export interface LoadingState {
  isLoading: boolean;
  error: string | null;
}

export interface DataState<T> extends LoadingState {
  data: T | null;
}
2. Enhanced API Client (src/services/api/client.ts)
Copyimport { type ApiResponse } from '../../types/news';

const BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://127.0.0.1:8000/api/v1';
const API_TOKEN = import.meta.env.VITE_API_TOKEN || '8|o0MM5b8VLbzndqREiW4VJHYG3ThxE554Z9F67q9q8ce7b00e';

export class ApiError extends Error {
  constructor(
    message: string,
    public status?: number,
    public data?: any
  ) {
    super(message);
    this.name = 'ApiError';
  }
}

class ApiClient {
  private headers: HeadersInit;
  private retryAttempts = 3;
  private retryDelay = 1000;

  constructor() {
    this.headers = {
      'Content-Type': 'application/json',
      'Accept': 'application/json',
      'Authorization': `Bearer ${API_TOKEN}`,
    };
  }

  async get<T>(endpoint: string, params?: Record<string, any>): Promise<T> {
    const url = this.buildUrl(endpoint, params);
    return this.fetchWithRetry<T>(url, { method: 'GET' });
  }

  async post<T>(endpoint: string, data?: any): Promise<T> {
    const url = `${BASE_URL}${endpoint}`;
    return this.fetchWithRetry<T>(url, {
      method: 'POST',
      body: data ? JSON.stringify(data) : undefined,
    });
  }

  async put<T>(endpoint: string, data: any): Promise<T> {
    const url = `${BASE_URL}${endpoint}`;
    return this.fetchWithRetry<T>(url, {
      method: 'PUT',
      body: JSON.stringify(data),
    });
  }

  async delete<T>(endpoint: string): Promise<T> {
    const url = `${BASE_URL}${endpoint}`;
    return this.fetchWithRetry<T>(url, { method: 'DELETE' });
  }

  private async fetchWithRetry<T>(
    url: string,
    options: RequestInit = {},
    attempt: number = 1
  ): Promise<T> {
    try {
      return await this.fetch<T>(url, options);
    } catch (error) {
      if (attempt < this.retryAttempts && this.shouldRetry(error)) {
        await this.delay(this.retryDelay * attempt);
        return this.fetchWithRetry<T>(url, options, attempt + 1);
      }
      throw error;
    }
  }

  private async fetch<T>(url: string, options: RequestInit = {}): Promise<T> {
    try {
      const response = await fetch(url, {
        headers: this.headers,
        ...options,
      });

      const contentType = response.headers.get('content-type');
      const isJson = contentType?.includes('application/json');

      if (!response.ok) {
        let errorMessage = `API Error: ${response.status} ${response.statusText}`;
        let errorData = null;

        if (isJson) {
          try {
            errorData = await response.json();
            errorMessage = errorData.message || errorMessage;
          } catch {
            // Ignore JSON parse error
          }
        }

        throw new ApiError(errorMessage, response.status, errorData);
      }

      if (!isJson) {
        throw new ApiError('Invalid response format: Expected JSON');
      }

      const data: ApiResponse<T> = await response.json();
      
      if (!data.success) {
        throw new ApiError(data.message || 'API request failed');
      }

      return data.data;
    } catch (error) {
      if (error instanceof ApiError) {
        throw error;
      }
      
      if (error instanceof TypeError && error.message.includes('fetch')) {
        throw new ApiError('Network error: Unable to connect to server');
      }

      throw new ApiError(
        error instanceof Error ? error.message : 'Unknown error occurred'
      );
    }
  }

  private buildUrl(endpoint: string, params?: Record<string, any>): string {
    const url = new URL(`${BASE_URL}${endpoint}`);
    
    if (params) {
      Object.keys(params).forEach(key => {
        const value = params[key];
        if (value !== undefined && value !== null && value !== '') {
          url.searchParams.append(key, value.toString());
        }
      });
    }
    
    return url.toString();
  }

  private shouldRetry(error: unknown): boolean {
    if (error instanceof ApiError) {
      // Retry on network errors or 5xx server errors
      return !error.status || error.status >= 500;
    }
    return true;
  }

  private delay(ms: number): Promise<void> {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}

export const apiClient = new ApiClient();
3. Enhanced Article Service (src/services/news/articleService.ts)
Copyimport { apiEndpoints } from '../api/endpoints';
import { type Article, type ApiArticle, type ArticleFilters } from '../../types/news';

export class ArticleService {
  async getArticles(filters: ArticleFilters = {}): Promise<Article[]> {
    try {
      const apiArticles = await apiEndpoints.articles.list(filters);
      return Array.isArray(apiArticles) 
        ? apiArticles.map(article => this.formatArticle(article))
        : [];
    } catch (error) {
      console.error('ArticleService.getArticles error:', error);
      throw error;
    }
  }

  async getArticle(id: string): Promise<Article | null> {
    try {
      const apiArticle = await apiEndpoints.articles.get(id);
      return apiArticle ? this.formatArticle(apiArticle) : null;
    } catch (error) {
      console.error(`ArticleService.getArticle(${id}) error:`, error);
      return null;
    }
  }

  async getLatestArticles(limit: number = 10): Promise<Article[]> {
    try {
      const apiArticles = await apiEndpoints.news.latest(limit);
      return Array.isArray(apiArticles)
        ? apiArticles.map(article => this.formatArticle(article))
        : [];
    } catch (error) {
      console.error('ArticleService.getLatestArticles error:', error);
      return [];
    }
  }

  async getTrendingArticles(limit: number = 5): Promise<Article[]> {
    try {
      const apiArticles = await apiEndpoints.news.trending(limit);
      return Array.isArray(apiArticles)
        ? apiArticles.map(article => this.formatArticle(article))
        : [];
    } catch (error) {
      console.error('ArticleService.getTrendingArticles error:', error);
      return [];
    }
  }

  async getFeaturedArticles(): Promise<Article[]> {
    try {
      const apiArticles = await apiEndpoints.news.featured();
      return Array.isArray(apiArticles)
        ? apiArticles.map(article => this.formatArticle(article))
        : [];
    } catch (error) {
      console.error('ArticleService.getFeaturedArticles error:', error);
      return [];
    }
  }

  async getArticlesByCategory(category: string, limit?: number): Promise<Article[]> {
    try {
      const apiArticles = await apiEndpoints.news.byCategory(category, limit);
      return Array.isArray(apiArticles)
        ? apiArticles.map(article => this.formatArticle(article))
        : [];
    } catch (error) {
      console.error(`ArticleService.getArticlesByCategory(${category}) error:`, error);
      return [];
    }
  }

  async searchArticles(query: string, limit?: number): Promise<Article[]> {
    try {
      if (!query.trim()) return [];
      const apiArticles = await apiEndpoints.news.search(query, limit);
      return Array.isArray(apiArticles)
        ? apiArticles.map(article => this.formatArticle(article))
        : [];
    } catch (error) {
      console.error(`ArticleService.searchArticles(${query}) error:`, error);
      return [];
    }
  }

  async getRelatedArticles(articleId: string, limit: number = 3): Promise<Article[]> {
    try {
      const apiArticles = await apiEndpoints.articles.related(articleId);
      return Array.isArray(apiArticles)
        ? apiArticles.map(article => this.formatArticle(article)).slice(0, limit)
        : [];
    } catch (error) {
      console.error(`ArticleService.getRelatedArticles(${articleId}) error:`, error);
      return [];
    }
  }

  async recordView(articleId: string): Promise<void> {
    try {
      await apiEndpoints.articles.recordView(articleId);
    } catch (error) {
      console.error(`ArticleService.recordView(${articleId}) error:`, error);
      // Don't throw - view recording is non-critical
    }
  }

  private formatArticle(apiArticle: ApiArticle): Article {
    const wordCount = apiArticle.content ? apiArticle.content.split(/\s+/).length : 100;
    const readTime = Math.max(1, Math.ceil(wordCount / 200));

    const summary = apiArticle.description || 
                   apiArticle.meta_description || 
                   apiArticle.excerpt || 
                   apiArticle.summary ||
                   this.createSummary(apiArticle.title);

    const content = apiArticle.content || 
                   apiArticle.description || 
                   apiArticle.summary || 
                   '';

    const tags = this.parseTags(apiArticle.tags, apiArticle.category);
    const categoryName = apiArticle.category_model?.name || apiArticle.category;

    return {
      id: apiArticle.id.toString(),
      title: apiArticle.title,
      summary: summary,
      content: content,
      author: apiArticle.author || 'DefinePress Staff',
      publishedAt: apiArticle.published_at,
      imageUrl: apiArticle.image_url || this.getFallbackImage(apiArticle.category),
      category: apiArticle.category,
      readTime: readTime,
      tags: tags,
      url: apiArticle.url,
      source: apiArticle.source || undefined,
      viewCount: apiArticle.view_count,
      isFeatured: apiArticle.is_featured,
    };
  }

  private parseTags(tags: string | string[] | null, category: string): string[] {
    if (!tags) return [category];

    try {
      if (typeof tags === 'string') {
        // Try parsing as JSON first
        try {
          const parsed = JSON.parse(tags);
          return Array.isArray(parsed) ? parsed : [category];
        } catch {
          // Parse as comma-separated string
          return tags.split(',').map(tag => tag.trim()).filter(tag => tag.length > 0);
        }
      }
      return Array.isArray(tags) ? tags : [category];
    } catch {
      return [category];
    }
  }

  private createSummary(title: string): string {
    return `${title}. Read more for the full story and latest updates.`;
  }

  private getFallbackImage(category: string): string {
    const fallbackImages: { [key: string]: string } = {
      'world': 'https://images.pexels.com/photos/87651/earth-blue-planet-globe-planet-87651.jpeg',
      'business': 'https://images.pexels.com/photos/210607/pexels-photo-210607.jpeg',
      'technology': 'https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg',
      'sports': 'https://images.pexels.com/photos/46798/the-ball-stadion-football-the-pitch-46798.jpeg',
      'health': 'https://images.pexels.com/photos/40568/medical-appointment-doctor-healthcare-40568.jpeg',
      'science': 'https://images.pexels.com/photos/256262/pexels-photo-256262.jpeg',
      'entertainment': 'https://images.pexels.com/photos/1299391/pexels-photo-1299391.jpeg',
      'general': 'https://images.pexels.com/photos/158651/news-newsletter-newspaper-information-158651.jpeg',
    };

    return fallbackImages[category] || fallbackImages['general'];
  }
}

export const articleService = new ArticleService();
4. Enhanced Category Service (src/services/news/categoryService.ts)
Copyimport { apiEndpoints } from '../api/endpoints';
import { type Category, type ApiCategory, type ApiArticle } from '../../types/news';

export class CategoryService {
  private colorMap: Map<string, string>;

  constructor() {
    this.colorMap = new Map([
      ['world', 'bg-red-500'],
      ['business', 'bg-green-500'],
      ['technology', 'bg-blue-500'],
      ['sports', 'bg-orange-500'],
      ['health', 'bg-purple-500'],
      ['science', 'bg-indigo-500'],
      ['general', 'bg-gray-500'],
      ['entertainment', 'bg-pink-500'],
      ['politics', 'bg-yellow-500'],
      ['environment', 'bg-emerald-500'],
      ['finance', 'bg-lime-500'],
      ['education', 'bg-cyan-500'],
    ]);
  }

  async getCategories(): Promise<Category[]> {
    try {
      const apiCategories = await apiEndpoints.categories.list();
      
      if (Array.isArray(apiCategories) && apiCategories.length > 0) {
        return apiCategories.map(cat => this.formatCategory(cat));
      }
      
      // Fallback: Extract from articles
      console.warn('No categories from API, extracting from articles...');
      return this.extractCategoriesFromArticles();
    } catch (error) {
      console.error('CategoryService.getCategories error:', error);
      return this.extractCategoriesFromArticles();
    }
  }

  async getCategory(slug: string): Promise<Category | null> {
    try {
      const apiCategory = await apiEndpoints.categories.get(slug);
      return apiCategory ? this.formatCategory(apiCategory) : null;
    } catch (error) {
      console.error(`CategoryService.getCategory(${slug}) error:`, error);
      // Try to find from all categories
      const categories = await this.getCategories();
      return categories.find(cat => cat.slug === slug) || null;
    }
  }

  async getPopularCategories(limit: number = 6): Promise<Category[]> {
    try {
      const categories = await this.getCategories();
      return categories
        .sort((a, b) => (b.articleCount || 0) - (a.articleCount || 0))
        .slice(0, limit);
    } catch (error) {
      console.error('CategoryService.getPopularCategories error:', error);
      return [];
    }
  }

  private async extractCategoriesFromArticles(): Promise<Category[]> {
    try {
      const articles = await apiEndpoints.articles.list({ perPage: 100 });
      
      if (!Array.isArray(articles) || articles.length === 0) {
        return this.getFallbackCategories();
      }
      
      return this.buildCategoriesFromArticles(articles);
    } catch (error) {
      console.error('CategoryService.extractCategoriesFromArticles error:', error);
      return this.getFallbackCategories();
    }
  }

  private buildCategoriesFromArticles(articles: ApiArticle[]): Category[] {
    const categoryMap = new Map<string, { count: number; name: string }>();
    
    articles.forEach(article => {
      const categorySlug = article.category || 'general';
      const categoryName = article.category_model?.name || this.formatCategoryName(categorySlug);
      
      if (categoryMap.has(categorySlug)) {
        categoryMap.get(categorySlug)!.count++;
      } else {
        categoryMap.set(categorySlug, {
          count: 1,
          name: categoryName
        });
      }
    });

    const categories: Category[] = [];
    let idCounter = 1;
    
    for (const [slug, data] of categoryMap.entries()) {
      categories.push({
        id: (idCounter++).toString(),
        name: data.name,
        slug: slug,
        description: this.generateCategoryDescription(slug, data.name),
        color: this.getCategoryColor(slug),
        articleCount: data.count,
        isActive: true
      });
    }

    return categories.sort((a, b) => (b.articleCount || 0) - (a.articleCount || 0));
  }

  private formatCategory(apiCategory: ApiCategory): Category {
    return {
      id: apiCategory.id.toString(),
      name: apiCategory.name,
      slug: apiCategory.slug,
      description: apiCategory.description || this.generateCategoryDescription(apiCategory.slug, apiCategory.name),
      color: this.getCategoryColor(apiCategory.slug),
      isActive: apiCategory.is_active,
    };
  }

  private formatCategoryName(slug: string): string {
    return slug.charAt(0).toUpperCase() + slug.slice(1).replace(/-/g, ' ');
  }

  private generateCategoryDescription(slug: string, name: string): string {
    const descriptions: { [key: string]: string } = {
      'world': 'Global news and international affairs from around the world',
      'business': 'Financial markets, economy, and business news',
      'technology': 'Latest technology trends, innovations, and digital transformation',
      'sports': 'Sports news, scores, highlights, and analysis',
      'health': 'Health, wellness, medical breakthroughs, and healthcare news',
      'science': 'Scientific discoveries, research, and innovation',
      'general': 'General news and current events',
      'entertainment': 'Entertainment news, celebrity updates, and pop culture',
      'politics': 'Political news, government affairs, and policy updates',
      'environment': 'Environmental news, climate change, and sustainability',
    };

    return descriptions[slug] || `Latest ${name} news and comprehensive coverage`;
  }

  private getCategoryColor(slug: string): string {
    if (this.colorMap.has(slug)) {
      return this.colorMap.get(slug)!;
    }

    const colors = [
      'bg-red-500', 'bg-blue-500', 'bg-green-500', 'bg-yellow-500', 
      'bg-purple-500', 'bg-pink-500', 'bg-indigo-500', 'bg-orange-500',
      'bg-teal-500', 'bg-cyan-500', 'bg-lime-500', 'bg-amber-500',
    ];

    let hash = 0;
    for (let i = 0; i < slug.length; i++) {
      hash = slug.charCodeAt(i) + ((hash << 5) - hash);
    }
    
    const index = Math.abs(hash) % colors.length;
    return colors[index];
  }

  private getFallbackCategories(): Category[] {
    return [
      {
        id: '1',
        name: 'General',
        slug: 'general',
        description: 'General news and current events',
        color: 'bg-gray-500',
        isActive: true
      },
      {
        id: '2',
        name: 'Technology',
        slug: 'technology',
        description: 'Latest technology trends and innovations',
        color: 'bg-blue-500',
        isActive: true
      },
      {
        id: '3',
        name: 'Business',
        slug: 'business',
        description: 'Business and financial news',
        color: 'bg-green-500',
        isActive: true
      }
    ];
  }
}

export const categoryService = new CategoryService();
5. Loading Skeleton Components (src/components/LoadingSkeletons.tsx)
Copyimport React from 'react';

export const ArticleCardSkeleton: React.FC = () => (
  <div className="bg-white rounded-lg overflow-hidden shadow-sm border border-gray-200 animate-pulse">
    <div className="h-48 bg-gray-200"></div>
    <div className="p-4 space-y-3">
      <div className="h-4 bg-gray-200 rounded w-1/4"></div>
      <div className="h-6 bg-gray-200 rounded w-3/4"></div>
      <div className="h-4 bg-gray-200 rounded w-full"></div>
      <div className="flex items-center space-x-4 mt-4">
        <div className="h-3 bg-gray-200 rounded w-1/4"></div>
        <div className="h-3 bg-gray-200 rounded w-1/4"></div>
      </div>
    </div>
  </div>
);

export const ArticleGridSkeleton: React.FC<{ count?: number }> = ({ count = 6 }) => (
  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {Array.from({ length: count }).map((_, index) => (
      <ArticleCardSkeleton key={index} />
    ))}
  </div>
);

export const CategorySectionSkeleton: React.FC = () => (
  <div className="space-y-6 animate-pulse">
    <div className="flex items-center justify-between">
      <div>
        <div className="h-8 bg-gray-200 rounded w-32 mb-2"></div>
        <div className="w-20 h-1.5 bg-gray-200 rounded-full"></div>
      </div>
      <div className="h-6 bg-gray-200 rounded w-24"></div>
    </div>
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <div className="lg:col-span-2">
        <ArticleCardSkeleton />
      </div>
      <div className="space-y-4">
        {Array.from({ length: 2 }).map((_, index) => (
          <ArticleCardSkeleton key={index} />
        ))}
      </div>
    </div>
  </div>
);

export const ArticlePageSkeleton: React.FC = () => (
  <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-pulse">
    <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
      <article className="lg:col-span-3">
        <div className="mb-6 space-y-2">
          <div className="h-4 bg-gray-200 rounded w-3/4"></div>
        </div>
        <div className="mb-8">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="h-12 bg-gray-200 rounded w-full mb-4"></div>
          <div className="h-6 bg-gray-200 rounded w-full mb-4"></div>
          <div className="flex items-center space-x-4">
            <div className="w-10 h-10 bg-gray-200 rounded-full"></div>
            <div className="flex-1 space-y-2">
              <div className="h-4 bg-gray-200 rounded w-1/4"></div>
              <div className="h-3 bg-gray-200 rounded w-1/3"></div>
            </div>
          </div>
        </div>
        <div className="mb-8 h-96 bg-gray-200 rounded-lg"></div>
        <div className="space-y-4">
          {Array.from({ length: 5 }).map((_, index) => (
            <div key={index} className="h-4 bg-gray-200 rounded w-full"></div>
          ))}
        </div>
      </article>
      <aside className="lg:col-span-1">
        <div className="sticky top-24 space-y-8">
          <div className="h-64 bg-gray-200 rounded-lg"></div>
          <div className="h-48 bg-gray-200 rounded-lg"></div>
        </div>
      </aside>
    </div>
  </div>
);

export const CategoryPageSkeleton: React.FC = () => (
  <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-pulse">
    <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
      <div className="lg:col-span-3">
        <div className="mb-8">
          <div className="h-10 bg-gray-200 rounded w-1/3 mb-4"></div>
          <div className="h-6 bg-gray-200 rounded w-2/3 mb-4"></div>
          <div className="w-16 h-1 bg-gray-200 rounded"></div>
        </div>
        <div className="mb-6 p-4 bg-white rounded-lg shadow-sm border border-gray-200 space-y-4">
          <div className="h-10 bg-gray-200 rounded"></div>
          <div className="flex justify-between">
            <div className="h-10 bg-gray-200 rounded w-32"></div>
            <div className="h-10 bg-gray-200 rounded w-32"></div>
          </div>
        </div>
        <ArticleGridSkeleton count={4} />
      </div>
      <div className="lg:col-span-1">
        <div className="sticky top-24 space-y-8">
          <div className="h-64 bg-gray-200 rounded-lg"></div>
          <div className="h-48 bg-gray-200 rounded-lg"></div>
        </div>
      </div>
    </div>
  </div>
);

export const LandingPageSkeleton: React.FC = () => (
  <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-8">
    <div className="mb-10 md:mb-12 animate-pulse">
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-10 sm:gap-6 lg:gap-8">
        <div className="lg:col-span-2">
          <div className="h-8 bg-gray-200 rounded w-32 mb-6"></div>
          <div className="h-96 bg-gray-200 rounded-lg"></div>
        </div>
        <div className="h-64 bg-gray-200 rounded-lg"></div>
      </div>
    </div>
    <div className="space-y-16">
      {Array.from({ length: 3 }).map((_, index) => (
        <CategorySectionSkeleton key={index} />
      ))}
    </div>
  </div>
);
6. Enhanced Data Service (src/data/dataService.ts)
Copyimport { type Article, type Category, type ArticleFilters } from '../types/news';
import { categoryService } from '../services/news/categoryService';
import { articleService } from '../services/news/articleService';

/**
 * DataService - Main data access layer with caching and error handling
 */
class DataService {
  private static instance: DataService | null = null;

  // Caches with TTL
  private categoriesCache: { data: Category[]; fetchedAt: number } | null = null;
  private articlesCache: Map<string, { data: Article[]; fetchedAt: number }> = new Map();

  // Cache TTL (5 minutes)
  private readonly DEFAULT_TTL = 1000 * 60 * 5;

  private constructor() {}

  static getInstance(): DataService {
    if (!DataService.instance) {
      DataService.instance = new DataService();
    }
    return DataService.instance;
  }

  // ----------------------
  // Categories
  // ----------------------

  async getCategories(options?: { forceRefresh?: boolean }): Promise<Category[]> {
    const force = options?.forceRefresh ?? false;

    // Return cached data if valid
    if (!force && this.categoriesCache) {
      const age = Date.now() - this.categoriesCache.fetchedAt;
      if (age < this.DEFAULT_TTL) {
        return this.categoriesCache.data;
      }
    }

    try {
      const categories = await categoryService.getCategories();
      this.categoriesCache = { data: categories, fetchedAt: Date.now() };
      return categories;
    } catch (err) {
      console.error('DataService.getCategories: failed to fetch', err);
      // Return cached data if available
      if (this.categoriesCache) return this.categoriesCache.data;
      // Return empty array as last resort
      return [];
    }
  }

  getCategoriesSync(): Category[] {
    return this.categoriesCache?.data || [];
  }

  async getCategory(slug: string): Promise<Category | null> {
    try {
      const categories = await this.getCategories();
      return categories.find(c => c.slug === slug) || null;
    } catch (err) {
      console.error(`DataService.getCategory(${slug}) failed`, err);
      return null;
    }
  }

  async getPopularCategories(limit: number = 6): Promise<Category[]> {
    try {
      return await categoryService.getPopularCategories(limit);
    } catch (err) {
      console.error('DataService.getPopularCategories failed', err);
      const categories = await this.getCategories();
      return categories.slice(0, limit);
    }
  }

  // ----------------------
  // Articles
  // ----------------------

  async getArticles(filters: ArticleFilters = {}, options?: { forceRefresh?: boolean }): Promise<Article[]> {
    const cacheKey = this.generateCacheKey('articles', filters);
    const force = options?.forceRefresh ?? false;

    // Return cached data if valid
    const cached = this.articlesCache.get(cacheKey);
    if (!force && cached && Date.now() - cached.fetchedAt < this.DEFAULT_TTL) {
      return cached.data;
    }

    try {
      const articles = await articleService.getArticles(filters);
      this.articlesCache.set(cacheKey, { data: articles, fetchedAt: Date.now() });
      return articles;
    } catch (err) {
      console.error('DataService.getArticles: failed to fetch', err);
      // Return cached data if available
      if (cached) return cached.data;
      return [];
    }
  }

  async getArticleById(id: string): Promise<Article | null> {
    try {
      return await articleService.getArticle(id);
    } catch (err) {
      console.error(`DataService.getArticleById(${id}) failed`, err);
      return null;
    }
  }

  async getArticlesByCategory(category: string, limit?: number, options?: { forceRefresh?: boolean }): Promise<Article[]> {
    const cacheKey = this.generateCacheKey('category', { category, limit });
    const force = options?.forceRefresh ?? false;

    const cached = this.articlesCache.get(cacheKey);
    if (!force && cached && Date.now() - cached.fetchedAt < this.DEFAULT_TTL) {
      return cached.data;
    }

    try {
      const articles = await articleService.getArticlesByCategory(category, limit);
      this.articlesCache.set(cacheKey, { data: articles, fetchedAt: Date.now() });
      return articles;
    } catch (err) {
      console.error(`DataService.getArticlesByCategory(${category}) failed`, err);
      if (cached) return cached.data;
      return [];
    }
  }

  async getLatestArticles(limit: number = 10, options?: { forceRefresh?: boolean }): Promise<Article[]> {
    const cacheKey = this.generateCacheKey('latest', { limit });
    const force = options?.forceRefresh ?? false;

    const cached = this.articlesCache.get(cacheKey);
    if (!force && cached && Date.now() - cached.fetchedAt < this.DEFAULT_TTL) {
      return cached.data;
    }

    try {
      const articles = await articleService.getLatestArticles(limit);
      this.articlesCache.set(cacheKey, { data: articles, fetchedAt: Date.now() });
      return articles;
    } catch (err) {
      console.error('DataService.getLatestArticles failed', err);
      if (cached) return cached.data;
      return [];
    }
  }

  async getTrendingArticles(limit: number = 5): Promise<Article[]> {
    try {
      return await articleService.getTrendingArticles(limit);
    } catch (err) {
      console.error('DataService.getTrendingArticles failed', err);
      return this.getLatestArticles(limit);
    }
  }

  async getFeaturedArticles(): Promise<Article[]> {
    try {
      return await articleService.getFeaturedArticles();
    } catch (err) {
      console.error('DataService.getFeaturedArticles failed', err);
      return this.getLatestArticles(3);
    }
  }

  async searchArticles(query: string): Promise<Article[]> {
    if (!query.trim()) return [];
    
    try {
      return await articleService.searchArticles(query);
    } catch (err) {
      console.error(`DataService.searchArticles(${query}) failed`, err);
      return [];
    }
  }

  async getRelatedArticles(currentArticle: Article, limit: number = 3): Promise<Article[]> {
    try {
      const related = await articleService.getRelatedArticles(currentArticle.id, limit);
      
      // If no related articles, fallback to same category
      if (related.length === 0) {
        const categoryArticles = await this.getArticlesByCategory(currentArticle.category, limit + 1);
        return categoryArticles.filter(a => a.id !== currentArticle.id).slice(0, limit);
      }
      
      return related;
    } catch (err) {
      console.error(`DataService.getRelatedArticles(${currentArticle.id}) failed`, err);
      return [];
    }
  }

  async recordArticleView(articleId: string): Promise<void> {
    try {
      await articleService.recordView(articleId);
    } catch (err) {
      console.error(`DataService.recordArticleView(${articleId}) failed`, err);
    }
  }

  // ----------------------
  // Cache management
  // ----------------------

  clearCache(): void {
    this.categoriesCache = null;
    this.articlesCache.clear();
  }

  invalidateArticlesCache(filters: ArticleFilters = {}): void {
    const key = this.generateCacheKey('articles', filters);
    this.articlesCache.delete(key);
  }

  invalidateCategoryCache(category: string): void {
    const keys = Array.from(this.articlesCache.keys()).filter(k => k.includes(`category=${category}`));
    keys.forEach(key => this.articlesCache.delete(key));
  }

  // ----------------------
  // Utilities
  // ----------------------

  private generateCacheKey(prefix: string, filters: Record<string, any> = {}): string {
    const params = Object.entries(filters)
      .filter(([_, v]) => v !== undefined && v !== null && v !== '')
      .map(([k, v]) => `${k}=${String(v)}`)
      .sort()
      .join('&');
    return params ? `${prefix}?${params}` : prefix;
  }
}

// Singleton instance
export const dataService = DataService.getInstance();

// Named exports for compatibility
export const getArticlesByCategory = (category: string, limit?: number) => 
  dataService.getArticlesByCategory(category, limit);

export const getArticleById = (id: string) => 
  dataService.getArticleById(id);

export const getRelatedArticles = (article: Article, limit?: number) => 
  dataService.getRelatedArticles(article, limit);

export const searchArticles = (query: string) => 
  dataService.searchArticles(query);

export const getCategories = () => dataService.getCategories();
export const getCategoriesSync = () => dataService.getCategoriesSync();
export const getCategory = (slug: string) => dataService.getCategory(slug);
export const getPopularCategories = (limit?: number) => dataService.getPopularCategories(limit);
export const getArticles = (filters?: ArticleFilters) => dataService.getArticles(filters);
export const getLatestArticles = (limit?: number) => dataService.getLatestArticles(limit);
export const getTrendingArticles = (limit?: number) => dataService.getTrendingArticles(limit);
export const getFeaturedArticles = () => dataService.getFeaturedArticles();
export const recordArticleView = (id: string) => dataService.recordArticleView(id);
export const clearCache = () => dataService.clearCache();

// Export categories synchronously (they're loaded during navigation)
export const categories = dataService.getCategoriesSync();

export default dataService;
7. Environment Configuration (.env)
VITE_API_BASE_URL=http://127.0.0.1:8000/api/v1
VITE_API_TOKEN=8|o0MM5b8VLbzndqREiW4VJHYG3ThxE554Z9F67q9q8ce7b00e
8. Updated Landing Page with Loading States (src/pages/LandingPage.tsx)
Copyimport React, { useState, useEffect, useMemo } from 'react';
import { Link } from 'react-router-dom';
import { dataService } from '../data/dataService';
import { selectRandomAd, selectMultipleAds } from '../utils/randomAdSelector';
import { type Ad, type Article, type Category } from '../types';
import NewsCard from '../components/NewsCard';
import AdBanner from '../components/AdBanner';
import Pagination from '../components/Pagination';
import CategoryNavigation from '../components/CategoryNavigation';
import { LandingPageSkeleton, CategorySectionSkeleton } from '../components/LoadingSkeletons';
import './styles/landing.css';

const ARTICLES_PER_PAGE = 3;

const LandingPage: React.FC = () => {
  const [featuredAds, setFeaturedAds] = useState<Ad[]>([]);
  const [sidebarAd, setSidebarAd] = useState<Ad | null>(null);
  const [categoryArticles, setCategoryArticles] = useState<Map<string, Article[]>>(new Map());
  const [categories, setCategories] = useState<Category[]>([]);
  const [featuredArticle, setFeaturedArticle] = useState<Article | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [currentPages, setCurrentPages] = useState<Map<string, number>>(new Map());
  const [currentCategoryIndex, setCurrentCategoryIndex] = useState(0);

  // Generate random layout order
  const randomLayoutOrder = useMemo(() => {
    const layouts = [
      'hero-asymmetric',
      'wide-triple',
      'magazine-sidebar',
      'masonry-stack',
      'spotlight-flow',
      'alternating-media-text',
      'carousel-grid',
      'editorial-split',
      'timeline-feed',
      'visual-mosaic'
    ];
    
    return layouts.sort(() => Math.random() - 0.5);
  }, []);

  useEffect(() => {
    loadData();
  }, []);

  const loadData = async () => {
    try {
      setLoading(true);
      setError(null);
      
      // Load ads (non-blocking)
      const bannerAds = selectMultipleAds('landing', 2, 'banner');
      const sidebar = selectRandomAd('landing', 'sidebar');
      setFeaturedAds(bannerAds);
      setSidebarAd(sidebar);

      // Load categories first
      const categoriesData = await dataService.getCategories();
      if (!categoriesData || categoriesData.length === 0) {
        throw new Error('No categories available');
      }
      setCategories(categoriesData);

      // Load featured article
      try {
        const featured = await dataService.getFeaturedArticles();
        if (featured && featured.length > 0) {
          setFeaturedArticle(featured[0]);
        }
      } catch (err) {
        console.warn('Failed to load featured article:', err);
      }

      // Load articles for each category
      const articlesMap = new Map<string, Article[]>();
      const pagesMap = new Map<string, number>();
      
      await Promise.all(
        categoriesData.map(async (category) => {
          try {
            const articles = await dataService.getArticlesByCategory(category.slug, 20);
            articlesMap.set(category.slug, articles);
            pagesMap.set(category.slug, 1);
          } catch (err) {
            console.error(`Failed to load articles for ${category.slug}:`, err);
            articlesMap.set(category.slug, []);
            pagesMap.set(category.slug, 1);
          }
        })
      );
      
      setCategoryArticles(articlesMap);
      setCurrentPages(pagesMap);
    } catch (err) {
      console.error('Failed to load landing page data:', err);
      setError(err instanceof Error ? err.message : 'Failed to load content');
    } finally {
      setLoading(false);
    }
  };

  const handlePageChange = (categorySlug: string, page: number) => {
    setCurrentPages(prev => new Map(prev.set(categorySlug, page)));
    const categoryElement = document.querySelector(`[data-category="${categorySlug}"]`);
    if (categoryElement) {
      categoryElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  };

  const handleCategoryChange = (index: number) => {
    setCurrentCategoryIndex(index);
    const categoryElement = document.querySelector(`[data-category="${categories[index].slug}"]`);
    if (categoryElement) {
      categoryElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  };

  const getPaginatedArticles = (categorySlug: string): Article[] => {
    const articles = categoryArticles.get(categorySlug) || [];
    const currentPage = currentPages.get(categorySlug) || 1;
    
    if (articles.length <= 1) return articles;
    
    const firstArticle = articles[0];
    const remainingArticles = articles.slice(1);
    
    const startIndex = (currentPage - 1) * ARTICLES_PER_PAGE;
    const endIndex = startIndex + ARTICLES_PER_PAGE;
    const paginatedRemaining = remainingArticles.slice(startIndex, endIndex);
    
    return [firstArticle, ...paginatedRemaining];
  };

  const getTotalPages = (categorySlug: string): number => {
    const articles = categoryArticles.get(categorySlug) || [];
    if (articles.length <= 1) return 1;
    
    const remainingArticles = articles.length - 1;
    return Math.ceil(remainingArticles / ARTICLES_PER_PAGE);
  };

  const getLayoutConfig = (index: number) => {
    const layoutName = randomLayoutOrder[index % randomLayoutOrder.length];
    return { name: layoutName };
  };

  const renderCategoryLayout = (layoutConfig: any, articles: Article[]) => {
    if (!articles || articles.length === 0) {
      return (
        <div className="text-center py-8 text-gray-500">
          No articles available for this category.
        </div>
      );
    }

    const [firstArticle, secondArticle, ...remainingArticles] = articles;

    switch(layoutConfig.name) {
      case 'hero-asymmetric':
        return (
          <div className="space-y-3 md:space-y-0 md:grid md:grid-cols-1 lg:grid-cols-3 md:gap-5 lg:gap-6">
            <div className="lg:col-span-2">
              <NewsCard 
                article={firstArticle} 
                variant="large" 
                priority="high"
                isFirstInCategory={true}
                showCategory={true}
              />
            </div>
            <div className="space-y-3 md:space-y-5 md:grid md:grid-cols-2 md:gap-5 lg:grid-cols-1">
              {secondArticle && (
                <NewsCard 
                  article={secondArticle} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              )}
              {remainingArticles.map((article) => (
                <NewsCard 
                  key={article.id} 
                  article={article} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              ))}
            </div>
          </div>
        );

      case 'wide-triple':
        return (
          <div className="space-y-3 md:space-y-5 lg:space-y-6">
            <div>
              <NewsCard 
                article={firstArticle} 
                variant="wide" 
                priority="high"
                isFirstInCategory={true}
                showCategory={true}
              />
            </div>
            <div className="space-y-3 md:space-y-0 md:grid md:grid-cols-2 lg:grid-cols-3 md:gap-5 lg:gap-6">
              {secondArticle && (
                <div className="md:col-span-2 lg:col-span-1">
                  <NewsCard 
                    article={secondArticle} 
                    variant="compact" 
                    orientation="horizontal"
                    isFirstInCategory={false}
                    hideMetaMobile={true}
                    showCategory={true}
                  />
                </div>
              )}
              {remainingArticles.map((article) => (
                <NewsCard 
                  key={article.id} 
                  article={article} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              ))}
            </div>
          </div>
        );

      default:
        return (
          <div className="space-y-3 md:space-y-0 md:grid md:grid-cols-2 lg:grid-cols-3 md:gap-5 lg:gap-6">
            <div className="lg:col-span-2">
              <NewsCard 
                article={firstArticle} 
                variant="large" 
                priority="high"
                isFirstInCategory={true}
                showCategory={true}
              />
            </div>
            <div className="space-y-3 md:space-y-5 md:grid md:grid-cols-2 md:gap-5 lg:grid-cols-1">
              {secondArticle && (
                <NewsCard 
                  article={secondArticle} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              )}
              {remainingArticles.map((article) => (
                <NewsCard 
                  key={article.id} 
                  article={article} 
                  variant="compact" 
                  orientation="horizontal"
                  isFirstInCategory={false}
                  hideMetaMobile={true}
                  showCategory={true}
                />
              ))}
            </div>
          </div>
        );
    }
  };

  if (loading) {
    return <LandingPageSkeleton />;
  }

  if (error) {
    return (
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <div className="text-center">
          <svg className="mx-auto h-12 w-12 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <h3 className="mt-4 text-lg font-medium text-gray-900">Failed to Load Content</h3>
          <p className="mt-2 text-sm text-gray-500">{error}</p>
          <button
            onClick={loadData}
            className="mt-6 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"
          >
            Retry
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-8">
      {/* Featured Article Showcase */}
      {featuredArticle && (
        <section className="mb-10 md:mb-12 -mx-4 sm:mx-0">
          <div className="grid grid-cols-1 lg:grid-cols-3 gap-10 sm:gap-6 lg:gap-8">
            <div className="lg:col-span-2">
              <div className="flex items-center justify-between mb-6 px-4 sm:px-0">
                <div>
                  <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 mb-2">
                    Featured
                  </h2>
                  <div className="w-20 h-1.5 bg-gradient-to-r from-primary-600 to-primary-400 rounded-full"></div>
                </div>
              </div>
              <NewsCard 
                article={featuredArticle} 
                variant="hero" 
                priority="high"
                isFeaturedHero={true}
                isFirstInCategory={true}
                showCategory={true}
              />
            </div>
            
            {sidebarAd && (
              <div className="px-4 sm:px-0">
                <div className="sticky top-24">
                  <div className="bg-gray-50 rounded-lg p-1 border-2 border-gray-200">
                    <AdBanner ad={sidebarAd} placement="landing" />
                  </div>
                </div>
              </div>
            )}
          </div>
        </section>
      )}

      {/* Banner Ad 1 */}
      {featuredAds[0] && (
        <section className="mb-10 md:mb-16">
          <div className="bg-gradient-to-r from-gray-50 via-white to-gray-50 rounded-lg border-2 border-gray-200">
            <AdBanner ad={featuredAds[0]} placement="landing" />
          </div>
        </section>
      )}

      {/* Category Navigation */}
      {categories.length > 1 && (
        <section className="mb-8">
          <CategoryNavigation
            categories={categories}
            currentCategoryIndex={currentCategoryIndex}
            onCategoryChange={handleCategoryChange}
          />
        </section>
      )}

      {/* Category Sections */}
      <div className="space-y-10 md:space-y-20">
        {categories.map((category, categoryIndex) => {
          const paginatedArticles = getPaginatedArticles(category.slug);
          const totalPages = getTotalPages(category.slug);
          const currentPage = currentPages.get(category.slug) || 1;
          
          if (paginatedArticles.length === 0) return null;

          const layoutConfig = getLayoutConfig(categoryIndex);

          return (
            <React.Fragment key={category.id}>
              <section 
                className="scroll-mt-20"
                data-category={category.slug}
              >
                <div className="w-full">
                  <div className="flex items-center justify-between mb-8">
                    <div className="flex-1">
                      <div className="flex items-center space-x-3 mb-2">
                        <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 capitalize">
                          {category.name}
                        </h2>
                        <span className="hidden sm:inline-block px-3 py-1 bg-gray-100 text-gray-600 text-sm font-medium rounded-full">
                          {categoryArticles.get(category.slug)?.length || 0} articles
                        </span>
                      </div>
                      <div className="w-20 h-1.5 bg-gradient-to-r from-primary-600 to-primary-400 rounded-full"></div>
                    </div>
                    <Link
                      to={`/category/${category.slug}`}
                      className="group flex items-center space-x-2 text-primary-600 hover:text-primary-700 font-semibold text-sm md:text-base transition-colors"
                    >
                      <span>Explore all</span>
                      <svg className="w-5 h-5 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2.5} d="M9 5l7 7-7 7" />
                      </svg>
                    </Link>
                  </div>

                  <div className="w-full mb-8">
                    {renderCategoryLayout(layoutConfig, paginatedArticles)}
                  </div>

                  {totalPages > 1 && (
                    <div className="flex justify-center mt-8">
                      <Pagination
                        currentPage={currentPage}
                        totalPages={totalPages}
                        onPageChange={(page) => handlePageChange(category.slug, page)}
                      />
                    </div>
                  )}
                </div>
              </section>

              {categoryIndex === 2 && featuredAds[1] && (
                <section className="w-full my-10 md:my-12">
                  <div className="bg-gradient-to-r from-gray-50 via-white to-gray-50 rounded-lg p-1 border-2 border-gray-200">
                    <AdBanner ad={featuredAds[1]} placement="landing" />
                  </div>
                </section>
              )}
            </React.Fragment>
          );
        })}
      </div>

      {/* Newsletter Section */}
      <section className="mt-16 md:mt-24">
        <div className="relative bg-gradient-to-br from-primary-50 via-white to-primary-50/30 rounded-3xl overflow-hidden shadow-xl border border-primary-100">
          <div className="absolute inset-0 bg-grid-primary/[0.03] bg-[size:20px_20px]"></div>
          <div className="relative px-6 py-10 sm:px-8 sm:py-12 md:px-12 md:py-16">
            <div className="max-w-2xl mx-auto text-center">
              <div className="inline-flex items-center space-x-2 mb-4 px-4 py-2 bg-primary-100 text-primary-700 rounded-full text-sm font-semibold">
                <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                  <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                </svg>
                <span>Stay Informed</span>
              </div>
              
              <h2 className="text-3xl sm:text-4xl md:text-5xl font-bold text-gray-900 mb-6">
                Never Miss a Story
              </h2>
              <p className="text-lg md:text-xl text-gray-600 mb-8 leading-relaxed">
                Get the latest news and exclusive insights delivered straight to your inbox.
              </p>
              
              <form className="flex flex-col sm:flex-row gap-3 md:gap-4 max-w-lg mx-auto">
                <input
                  type="email"
                  placeholder="Enter your email address"
                  className="flex-1 px-5 md:px-6 py-3 md:py-4 text-base border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all bg-white shadow-sm"
                  required
                />
                <button
                  type="submit"
                  className="px-6 md:px-8 py-3 md:py-4 bg-primary-600 text-white text-base font-semibold rounded-xl hover:bg-primary-700 transition-all duration-300 shadow-lg hover:shadow-xl"
                >
                  Subscribe
                </button>
              </form>
              
              <p className="text-sm text-gray-500 mt-6">
                By subscribing, you agree to our <Link to="/privacy" className="text-primary-600 hover:underline">Privacy Policy</Link>.
              </p>
            </div>
          </div>
        </div>
      </section>
    </div>
  );
};

Also make a rewrite of this files so they work well with previously generated files:
import React, { useState, useEffect } from 'react';
import { Link, useLocation, useNavigate } from 'react-router-dom';
import { dataService } from '../data/dataService'
import { type Category } from '../types/news'; // Import the Category type
import SearchBar from './SearchBar';

const Navbar: React.FC = () => {
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const [categories, setCategories] = useState<Category[]>([]); // State for categories
  const [loading, setLoading] = useState(true);
  const location = useLocation();
  const navigate = useNavigate();

  // Load categories from API
  useEffect(() => {
    const loadCategories = async () => {
      try {
        setLoading(true);
        const categoriesData = await dataService.getCategories();
        setCategories(categoriesData);
      } catch (error) {
        console.error('Failed to load categories:', error);
        setCategories([]); // Fallback to empty array
      } finally {
        setLoading(false);
      }
    };

    loadCategories();
  }, []);

  // Prevent body scroll when menu is open
  useEffect(() => {
    if (isMobileMenuOpen) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'unset';
    }
    return () => {
      document.body.style.overflow = 'unset';
    };
  }, [isMobileMenuOpen]);

  const handleSearch = (query: string) => {
    if (query.trim()) {
      navigate(`/search?q=${encodeURIComponent(query.trim())}`);
      setIsMobileMenuOpen(false);
    }
  };

  const isActiveRoute = (path: string) => {
    return location.pathname === path;
  };

  // Show loading state
  if (loading) {
    return (
      <nav className="bg-white shadow-lg sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            <div className="flex-shrink-0">
              <Link to="/" className="text-2xl font-bold text-gray-800">
                DefinePress
              </Link>
            </div>
            <div className="hidden md:block">
              <div className="animate-pulse flex space-x-4">
                {[...Array(6)].map((_, i) => (
                  <div key={i} className="h-6 w-20 bg-gray-200 rounded"></div>
                ))}
              </div>
            </div>
          </div>
        </div>
      </nav>
    );
  }

  return (
    <nav className="bg-white shadow-lg sticky top-0 z-50">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center h-16">
          {/* Logo */}
          <div className="flex-shrink-0">
            <Link
              to="/"
              className="relative inline-block text-3xl font-extrabold tracking-tight text-transparent bg-clip-text 
               bg-gradient-to-r from-blue-400 via-blue-500 to-blue-700 
               hover:from-blue-500 hover:via-blue-600 hover:to-blue-800 
               transition-all duration-300"
            >
              Define<span className="text-gray-800">Press</span>
              <span className="absolute -bottom-1 left-0 w-full h-0.5 bg-gradient-to-r from-blue-400 to-blue-700 scale-x-0 hover:scale-x-100 origin-left transition-transform duration-300"></span>
            </Link>
          </div>

          {/* Desktop Navigation */}
          <div className="hidden md:block">
            <div className="ml-10 flex items-baseline space-x-4">
              <Link
                to="/"
                className={`px-3 py-2 rounded-md text-sm font-medium transition-colors ${
                  isActiveRoute('/') 
                    ? 'text-primary-600 bg-primary-50' 
                    : 'text-gray-700 hover:text-primary-600 hover:bg-gray-100'
                }`}
              >
                Home
              </Link>
              {categories.map((category) => (
                <Link
                  key={category.id}
                  to={`/category/${category.slug}`}
                  className={`px-3 py-2 rounded-md text-sm font-medium transition-colors capitalize ${
                    isActiveRoute(`/category/${category.slug}`)
                      ? 'text-primary-600 bg-primary-50'
                      : 'text-gray-700 hover:text-primary-600 hover:bg-gray-100'
                  }`}
                >
                  {category.name}
                </Link>
              ))}
            </div>
          </div>

          {/* Search Bar - Desktop */}
          <div className="hidden md:block">
            <SearchBar onSearch={handleSearch} placeholder="Search news..." showButton={false} />
          </div>

          {/* Mobile menu button */}
          <div className="md:hidden">
            <button
              onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
              className="inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-primary-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 transition-colors"
              aria-expanded={isMobileMenuOpen}
              aria-label="Toggle navigation menu"
            >
              <span className="sr-only">Open main menu</span>
              {!isMobileMenuOpen ? (
                <svg className="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                </svg>
              ) : (
                <svg className="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                </svg>
              )}
            </button>
          </div>
        </div>
      </div>

      {/* Mobile Navigation Menu */}
      {isMobileMenuOpen && (
        <>
          {/* Backdrop */}
          <div 
            className="md:hidden fixed inset-0 z-40 bg-gray-900/20 backdrop-blur-sm animate-fadeIn"
            onClick={() => setIsMobileMenuOpen(false)}
            aria-hidden="true"
          />
          
          {/* Sliding Menu Panel */}
          <div className="md:hidden fixed inset-y-0 right-0 z-50 w-full max-w-sm bg-white shadow-2xl animate-slideInRight">
            <div className="flex flex-col h-full">
              {/* Header Section */}
              <div className="flex items-center justify-between px-6 py-5">
                <div>
                  <h2 className="text-lg font-bold text-gray-900">Menu</h2>
                </div>
                <button
                  onClick={() => setIsMobileMenuOpen(false)}
                  className="p-2 rounded-lg text-gray-400 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500 transition-all duration-200"
                  aria-label="Close menu"
                >
                  <svg className="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>

              {/* Scrollable Content */}
              <div className="flex-1 overflow-y-auto pl-10 py-1 w-full">
                {/* Search Section */}
                <div className="mb-2">
                  <SearchBar 
                    onSearch={handleSearch} 
                    placeholder="Search news..." 
                    showButton={true}
                  />
                </div>

                {/* Navigation Links */}
                <div>
                  <nav className="space-y-1">
                    <Link
                      to="/"
                      className={`group flex items-center px-4 mt-6 py-1 rounded-lg text-base font-medium transition-all duration-200 ${
                        isActiveRoute('/')
                          ? 'text-primary-600 bg-primary-50 text-blue-500'
                          : 'text-gray-700 hover:text-gray-900 hover:bg-gray-50 border-l-4 border-transparent'
                      }`}
                      onClick={() => setIsMobileMenuOpen(false)}
                    >
                      <svg 
                        className={`w-5 h-5 mr-3 ${
                          isActiveRoute('/') ? 'text-primary-600' : 'text-gray-400'
                        }`}
                        fill="none" 
                        stroke="currentColor" 
                        viewBox="0 0 24 24"
                      >
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                      </svg>
                      <span>Home</span>
                    </Link>                  

                    {categories.map((category, index) => {
                      const isActive = isActiveRoute(`/category/${category.slug}`);
                      const categoryIcons = [
                        'M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z', // Technology
                        'M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z', // Business
                        'M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z', // Sports
                        'M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z', // Science
                        'M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z', // Entertainment
                        'M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z' // World
                      ];
                      
                      return (
                        <Link
                          key={category.id}
                          to={`/category/${category.slug}`}
                          className={`group flex items-center px-4 py-3 rounded-lg text-base font-medium capitalize transition-all duration-200 ${
                            isActive
                              ? 'text-primary-600 bg-primary-50 text-blue-500'
                              : 'text-gray-700 hover:text-gray-900 hover:bg-gray-50 border-l-4 border-transparent'
                          }`}
                          onClick={() => setIsMobileMenuOpen(false)}
                        >
                          <svg 
                            className={`w-5 h-5 mr-3 ${
                              isActive ? 'text-primary-600' : 'text-gray-400'
                            }`}
                            fill="none" 
                            stroke="currentColor" 
                            viewBox="0 0 24 24"
                          >
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d={categoryIcons[index % categoryIcons.length]} />
                          </svg>
                          <span>{category.name}</span>
                        </Link>
                      );
                    })}
                  </nav>
                </div>
              </div>

              {/* Footer Section */}
              <div className="px-6 py-4 border-t border-gray-100">
                <div className="flex items-center justify-between text-sm">
                  <span className="text-gray-500 text-xs">
                    Â© {new Date().getFullYear()} DefinePress
                  </span>
                  <div className="flex items-center space-x-4">
                    {/* Social icons */}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </>
      )}

      {/* Add custom animations */}
      <style>{`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes slideInRight {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        
        .animate-fadeIn {
          animation: fadeIn 0.2s ease-out;
        }
        
        .animate-slideInRight {
          animation: slideInRight 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
      `}</style>
    </nav>
  );
};

export default Navbar;
import React from 'react';
import { Link } from 'react-router-dom';
import { categories } from '../data/dataService';

const Footer: React.FC = () => {
  const currentYear = new Date().getFullYear();

  return (
    <footer className="bg-gray-900 text-white">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
          {/* Brand Section */}
          <div className="col-span-1 md:col-span-2">
            <Link to="/" className="text-2xl font-bold text-white hover:text-primary-400 transition-colors">
              DefinePress
            </Link>
            <p className="mt-4 text-gray-400 max-w-md">
              Your trusted source for breaking news, in-depth analysis, and comprehensive coverage 
              of global events. Stay informed with DefinePress.
            </p>
            <div className="mt-6 flex space-x-6">
              {/* Social Media Links */}
              <a 
                href="#" 
                className="text-gray-400 hover:text-primary-400 transition-colors"
                aria-label="Follow us on Twitter"
              >
                <svg className="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" />
                </svg>
              </a>
              <a 
                href="#" 
                className="text-gray-400 hover:text-primary-400 transition-colors"
                aria-label="Follow us on Facebook"
              >
                <svg className="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                  <path fillRule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clipRule="evenodd" />
                </svg>
              </a>
              <a 
                href="#" 
                className="text-gray-400 hover:text-primary-400 transition-colors"
                aria-label="Follow us on LinkedIn"
              >
                <svg className="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                  <path fillRule="evenodd" d="M19 0H5a5 5 0 00-5 5v14a5 5 0 005 5h14a5 5 0 005-5V5a5 5 0 00-5-5zM8 19H5V8h3v11zM6.5 6.732c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zM20 19h-3v-5.604c0-3.368-4-3.113-4 0V19h-3V8h3v1.765c1.396-2.586 7-2.777 7 2.476V19z" clipRule="evenodd" />
                </svg>
              </a>
              <a 
                href="#" 
                className="text-gray-400 hover:text-primary-400 transition-colors"
                aria-label="Follow us on Instagram"
              >
                <svg className="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                  <path fillRule="evenodd" d="M12.017 0C8.396 0 7.827.01 7.233.048 2.87.272.272 2.87.048 7.233.01 7.827 0 8.396 0 12.017c0 3.624.01 4.192.048 4.786.272 4.363 2.87 6.959 7.233 7.184.604.037 1.173.048 4.786.048 3.624 0 4.192-.01 4.786-.048 4.363-.272 6.959-2.87 7.184-7.233.037-.604.048-1.173.048-4.786 0-3.624-.01-4.192-.048-4.786C23.728 2.87 21.13.272 16.767.048 16.173.01 15.604 0 12.017 0zm0 2.158c3.556 0 3.978.01 5.387.048 2.7.123 4.177 1.6 4.3 4.301.038 1.409.048 1.831.048 5.387 0 3.556-.01 3.978-.048 5.387-.123 2.7-1.6 4.177-4.301 4.3-1.409.038-1.831.048-5.387.048-3.556 0-3.978-.01-5.387-.048-2.7-.123-4.177-1.6-4.3-4.301-.038-1.409-.048-1.831-.048-5.387 0-3.556.01-3.978.048-5.387.123-2.7 1.6-4.177 4.301-4.3 1.409-.038 1.831-.048 5.387-.048z" clipRule="evenodd" />
                  <path fillRule="evenodd" d="M12.017 5.838a6.18 6.18 0 100 12.36 6.18 6.18 0 000-12.36zm0 10.18a4 4 0 110-8 4 4 0 010 8zm7.846-10.405a1.441 1.441 0 11-2.883 0 1.441 1.441 0 012.883 0z" clipRule="evenodd" />
                </svg>
              </a>
            </div>
          </div>

          {/* Categories */}
          <div>
            <h3 className="text-lg font-semibold mb-4">Categories</h3>
            <ul className="space-y-2">
              {categories.slice(0, 6).map((category) => (
                <li key={category.id}>
                  <Link
                    to={`/category/${category.slug}`}
                    className="text-gray-400 hover:text-primary-400 transition-colors capitalize"
                  >
                    {category.name}
                  </Link>
                </li>
              ))}
            </ul>
          </div>

          {/* Quick Links */}
          <div>
            <h3 className="text-lg font-semibold mb-4">Quick Links</h3>
            <ul className="space-y-2">
              <li>
                <Link to="/about" className="text-gray-400 hover:text-primary-400 transition-colors">
                  About Us
                </Link>
              </li>
              <li>
                <Link to="/contact" className="text-gray-400 hover:text-primary-400 transition-colors">
                  Contact
                </Link>
              </li>
              <li>
                <Link to="/privacy" className="text-gray-400 hover:text-primary-400 transition-colors">
                  Privacy Policy
                </Link>
              </li>
              <li>
                <Link to="/terms" className="text-gray-400 hover:text-primary-400 transition-colors">
                  Terms of Service
                </Link>
              </li>
              {/* <li>
                <Link to="/advertise" className="text-gray-400 hover:text-primary-400 transition-colors">
                  Advertise With Us
                </Link>
              </li> */}
              {/* <li>
                <Link to="/newsletter" className="text-gray-400 hover:text-primary-400 transition-colors">
                  Newsletter
                </Link>
              </li> */}
            </ul>
          </div>
        </div>

        {/* Bottom Section */}
        <div className="mt-8 pt-8 border-t border-gray-800">
          <div className="flex flex-col md:flex-row justify-between items-center">
            <p className="text-gray-400 text-sm">
              Â© {currentYear} DefinePress. All rights reserved.
            </p>
            <div className="mt-4 md:mt-0 flex space-x-6">
              <Link to="/rss" className="text-gray-400 hover:text-primary-400 transition-colors text-sm">
                RSS Feed
              </Link>
              <Link to="/sitemap" className="text-gray-400 hover:text-primary-400 transition-colors text-sm">
                Sitemap
              </Link>
              <Link to="/accessibility" className="text-gray-400 hover:text-primary-400 transition-colors text-sm">
                Accessibility
              </Link>
            </div>
          </div>
        </div>
      </div>
    </footer>
  );
};

export default Footer;
import React, { useState, useEffect, useRef } from 'react';
import Navbar from './Navbar';
import Footer from './Footer';

interface LayoutProps {
  children: React.ReactNode;
  className?: string;
  isLoading?: boolean;
}

const Layout: React.FC<LayoutProps> = ({ children, className = '', isLoading = false }) => {
  const [showLoader, setShowLoader] = useState(isLoading);
  const [scrollProgress, setScrollProgress] = useState(0);

  // Sync loading state
  useEffect(() => {
    setShowLoader(isLoading);
  }, [isLoading]);

  // Track scroll progress for the reading progress bar
  useEffect(() => {
    const handleScroll = () => {
      const totalHeight = document.documentElement.scrollHeight - window.innerHeight;
      const progress = (window.pageYOffset / totalHeight) * 100;
      setScrollProgress(progress);
    };

    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  // Scroll to top when the page (Layout) mounts
  useEffect(() => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }, []);

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50 flex flex-col scroll-smooth">
      {/* Reading Progress Bar */}
      <div className="fixed top-0 left-0 right-0 z-50 h-1 bg-gray-200">
        <div
          className="h-full bg-gradient-to-r from-primary-500 via-primary-600 to-primary-700 transition-all duration-300 ease-out"
          style={{ width: `${scrollProgress}%` }}
        />
      </div>

      <Navbar />

      {/* Loader Overlay */}
      {showLoader && (
        <div className="fixed inset-0 z-50 flex items-center justify-center bg-white/95 backdrop-blur-md">
          <div className="flex flex-col items-center space-y-6 animate-fadeIn">
            {/* Multi-ring Spinner */}
            <div className="relative w-24 h-24">
              <div className="absolute inset-0 border-4 border-primary-200 rounded-full"></div>
              <div className="absolute inset-2 border-4 border-primary-500 rounded-full border-t-transparent animate-spin"></div>
              <div className="absolute inset-8 bg-primary-600 rounded-full animate-pulse"></div>
            </div>

            {/* Loading Text */}
            <div className="flex flex-col items-center space-y-3">
              <p className="text-xl font-bold text-gray-900 animate-pulse">Loading amazing content</p>
              <div className="flex space-x-2">
                <div className="w-3 h-3 bg-primary-500 rounded-full animate-bounce" style={{ animationDelay: '0ms' }}></div>
                <div className="w-3 h-3 bg-primary-600 rounded-full animate-bounce" style={{ animationDelay: '200ms' }}></div>
                <div className="w-3 h-3 bg-primary-700 rounded-full animate-bounce" style={{ animationDelay: '400ms' }}></div>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Main Content */}
      <main className={`flex-1 scroll-smooth relative ${className}`}>
        {/* Animated Background */}
        <div className="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
          <div className="absolute -top-1/2 -left-1/2 w-full h-full bg-gradient-to-br from-primary-50/30 via-transparent to-transparent animate-gradientShift"></div>
          <div
            className="absolute -bottom-1/2 -right-1/2 w-full h-full bg-gradient-to-tl from-primary-50/20 via-transparent to-transparent animate-gradientShift"
            style={{ animationDelay: '2s' }}
          ></div>
        </div>

        {children}
      </main>

      <Footer />

      <ScrollControls />
    </div>
  );
};

// ------------------------------------------------------------
// Scroll Controls Component
// ------------------------------------------------------------
const ScrollControls: React.FC = () => {
  const [isVisible, setIsVisible] = useState(false);
  const [showQuickNav, setShowQuickNav] = useState(false);
  const menuRef = useRef<HTMLDivElement>(null);

  // Show controls after scrolling down a bit
  useEffect(() => {
    const toggleVisibility = () => {
      setIsVisible(window.pageYOffset > 400);
    };

    window.addEventListener('scroll', toggleVisibility);
    return () => window.removeEventListener('scroll', toggleVisibility);
  }, []);

  // ðŸ†• Handle click outside to close the quick nav menu
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {
        setShowQuickNav(false);
      }
    };

    // Only add listener when menu is open
    if (showQuickNav) {
      document.addEventListener('mousedown', handleClickOutside);
    }

    return () => {
      document.removeEventListener('mousedown', handleClickOutside);
    };
  }, [showQuickNav]);

  const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
    setShowQuickNav(false); // ðŸ†• Close menu after action
  };

  const scrollToBottom = () => {
    window.scrollTo({ top: document.documentElement.scrollHeight, behavior: 'smooth' });
    setShowQuickNav(false); // ðŸ†• Close menu after action
  };

  return (
    <>
      {isVisible && (
        <div ref={menuRef} className="fixed bottom-6 right-6 z-40 flex flex-col space-y-3">
          {/* Quick Nav Toggle */}
          <button
            onClick={() => setShowQuickNav(!showQuickNav)}
            className="p-3 bg-slate-900 text-white rounded-full shadow-lg border-2 border-slate-700 hover:bg-slate-800 hover:scale-110 transition-all duration-300 group"
            aria-label="Quick navigation"
          >
            <svg
              className="w-6 h-6 transform group-hover:rotate-180 transition-transform duration-500"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                strokeLinecap="round"
                strokeLinejoin="round"
                strokeWidth={2.5}
                d="M13 10V3L4 14h7v7l9-11h-7z"
              />
            </svg>
          </button>

          {/* Quick Nav Menu */}
          {showQuickNav && (
            <div className="bg-slate-900/95 backdrop-blur-sm text-white rounded-2xl shadow-2xl border border-slate-700 p-2 space-y-2 animate-slideUp">
              <button
                onClick={scrollToTop}
                className="flex items-center space-x-2 w-full px-4 py-2 text-left text-sm font-medium hover:bg-slate-800 rounded-lg transition-colors"
              >
                <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2.5} d="M5 10l7-7m0 0l7 7m-7-7v18" />
                </svg>
                <span>Top</span>
              </button>

              <button
                onClick={scrollToBottom}
                className="flex items-center space-x-2 w-full px-4 py-2 text-left text-sm font-medium hover:bg-slate-800 rounded-lg transition-colors"
              >
                <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2.5} d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                </svg>
                <span>Bottom</span>
              </button>
            </div>
          )}
        </div>
      )}
    </>
  );
};

export default Layout;

